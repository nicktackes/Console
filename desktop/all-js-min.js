Ext.ns("Ext.ux");Ext.ux.FisheyeMenu=Ext.extend(Ext.util.Observable,{items:[],renderTo:document.body,itemWidth:50,vicinity:35,hAlign:"center",vAlign:"bottom",showTitle:true,constructor:function(a){Ext.apply(this,a);Ext.ux.FisheyeMenu.superclass.constructor.call(this);this.addEvents("change");this.init()},init:function(){this.el=Ext.get(this.renderTo);this.initMarkup();this.initEvents()},initMarkup:function(){this.setClass();this.el.addClass(this.wrapCls);this.containerEl=this.el.createChild({tag:"div",cls:"ux-fisheye-menu-container "+this.vAlignCls});var a=this.el.getAttribute("id")||Ext.id();Ext.each(this.items,function(e,d){var c=this.showTitle===true?(e.tip||e.text):"";var b=[{tag:"span",html:e.text},{tag:"img",src:e.imagePath,alt:c}];if(this.vOrient=="top"){b=b.reverse()}this.containerEl.createChild({tag:"a",id:a+"-"+d,cls:"ux-fisheye-menu-item "+this.vAlignCls,href:e.url||"#",onclick:e.onclick,title:c,target:e.target||"_blank",children:b})},this);this.menuItems=this.containerEl.select("a.ux-fisheye-menu-item");this.itemCount=this.menuItems.getCount();this.onRender()},initEvents:function(){this.menuItems.on("mouseover",this.onItemHover,this);this.menuItems.on("mouseout",this.onItemOut,this);Ext.getBody().on("mousemove",this.onItemMove,this);Ext.EventManager.on(window,"resize",this.onRender,this);this.containerEl.on("click",function(c,b){if(b.href.slice(-1)=="#"){c.preventDefault()}var a=parseInt(b.id.split("-").pop(),10);this.fireEvent("change",b,a)},this,{delegate:"a"})},setClass:function(){this.vOrient=this.vAlign.toLowerCase();this.wrapCls="menu-wrap-"+this.vOrient;this.vAlignCls="menu-align-"+this.vOrient},onItemMove:function(c,b){var d=c.getXY(),f,e,a=0;switch(this.hAlign.toLowerCase()){case"left":f=d[0]-this.pos[0];break;case"right":f=d[0]-this.pos[0]-this.el.getWidth()+this.itemWidth*this.itemCount;break;default:f=d[0]-this.pos[0]-(this.el.getWidth()-this.itemWidth*this.itemCount)/2-this.itemWidth/2;break}e=Math.pow(d[1]-this.pos[1]-this.el.getHeight()/2,2);this.menuItems.each(function(i,h,g){var k=Math.sqrt(Math.pow(f-g*this.itemWidth,2)+e);k-=this.itemWidth/2;k=k<0?0:k;k=k>this.vicinity?this.vicinity:k;k=this.vicinity-k;var j=this.itemWidth*k/this.vicinity;i.setStyle({left:this.itemWidth*g+a+"px",width:this.itemWidth+j+"px"});a+=j},this);this.setPosContainer(a)},onItemHover:function(c,b){var d=Ext.get(b);d=d.is("img")?d.up("a"):d;var a=d.child("span");if(a){a.show()}},onItemOut:function(c,b){var d=Ext.get(b);d=d.is("img")?d.up("a"):d;var a=d.child("span");if(a){a.hide()}},onRender:function(){this.pos=this.el.getXY();this.setPosContainer(0);this.setPosMenuItems()},doAlignment:function(){var a=["menu-wrap-top","menu-wrap-bottom"],b=["menu-align-top","menu-align-bottom"];this.setClass();this.el.removeClass(a).addClass(this.wrapCls);this.containerEl.removeClass(b).addClass(this.vAlignCls);this.menuItems.each(function(g,e,d){var c=g.child("span");var f={tag:"span",html:c.dom.innerHTML};g.removeClass(b).addClass(this.vAlignCls);if(this.vAlign.toLowerCase()=="top"){if(!g.last().is("span")){g.createChild(f);c.remove()}}else{if(!g.first().is("span")){g.insertFirst(f);c.remove()}}},this)},setAlign:function(a){var d=false;if(a.hAlign){var c=a.hAlign.toLowerCase();if(c!=this.hAlign.toLowerCase()){this.hAlign=c;d=true}}if(a.vAlign){var b=a.vAlign.toLowerCase();if(b!=this.vAlign.toLowerCase()){this.vAlign=b;d=true}}if(d){this.doAlignment();this.onRender()}},setPosContainer:function(a){var b;switch(this.hAlign.toLowerCase()){case"left":b=-a/this.itemCount;break;case"right":b=(this.el.getWidth()-this.itemWidth*this.itemCount)-a/2;break;default:b=(this.el.getWidth()-this.itemWidth*this.itemCount)/2-a/2;break}this.containerEl.setStyle({left:b+"px",width:this.itemWidth*this.itemCount+a+"px"})},setPosMenuItems:function(){this.menuItems.each(function(c,b,a){c.setStyle({left:this.itemWidth*a+"px",width:this.itemWidth+"px"})},this)}});Ext.ux.FisheyeMenuExtention=Ext.extend(Ext.ux.FisheyeMenu,{constructor:function(a){Ext.apply(this,a);Ext.ux.FisheyeMenuExtention.superclass.constructor.call(this)},addItem:function(e){var d=this.el.getAttribute("id")||Ext.id();var c=this.containerEl.select("a.ux-fisheye-menu-item").getCount();var b=this.showTitle===true?(e.tip||e.text):"";var a=[{tag:"span",html:e.text},{tag:"img",src:e.imagePath,alt:b}];if(this.vOrient=="top"){a=a.reverse()}this.containerEl.createChild({tag:"a",id:d+"-"+c,cls:"ux-fisheye-menu-item "+this.vAlignCls,href:e.url||"#",title:b,target:e.target||"_blank",children:a});this.menuItems=this.containerEl.select("a.ux-fisheye-menu-item");this.itemCount=this.menuItems.getCount();this.onRender();this.menuItems.on("mouseover",this.onItemHover,this);this.menuItems.on("mouseout",this.onItemOut,this)},removeItem:function(b){var a="fisheye-menu-"+b,c=Ext.get(a);if(!c){alert("cannot find the menu item!")}else{c.remove();this.menuItems=this.containerEl.select("a.ux-fisheye-menu-item");this.itemCount=this.menuItems.getCount();this.onRender()}}});/*
 * Ext JS Library 3.3.1
 * Copyright(c) 2006-2010 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.ns("Ext.ux.grid");Ext.ux.grid.CheckColumn=Ext.extend(Ext.grid.Column,{processEvent:function(c,f,d,g,b){if(c=="mousedown"){var a=d.store.getAt(g);a.set(this.dataIndex,!a.data[this.dataIndex]);return false}else{return Ext.grid.ActionColumn.superclass.processEvent.apply(this,arguments)}},renderer:function(b,c,a){c.css+=" x-grid3-check-col-td";return String.format('<div class="x-grid3-check-col{0}">&#160;</div>',b?"-on":"")},init:Ext.emptyFn});Ext.preg("checkcolumn",Ext.ux.grid.CheckColumn);Ext.grid.CheckColumn=Ext.ux.grid.CheckColumn;Ext.grid.Column.types.checkcolumn=Ext.ux.grid.CheckColumn;Ext.namespace("Ext.ux.plugin");Ext.onReady(function(){var a=Ext.util.CSS;if(a){a.getRule(".x-hide-nosize")||a.createStyleSheet(".x-hide-nosize{height:0px!important;width:0px!important;border:none!important;zoom:1;}.x-hide-nosize * {height:0px!important;width:0px!important;border:none!important;zoom:1;}");a.refreshCache()}});(function(){var h=Ext.Element,b=Ext.lib.Anim,a=h.prototype;var g="visibility",e="display",c="hidden",i="none";var f={};f.El={setDisplayed:function(k){var j=this;j.visibilityCls?(j[k!==false?"removeClass":"addClass"](j.visibilityCls)):a.setDisplayed.call(j,k);return j},isDisplayed:function(){return !(this.hasClass(this.visibilityCls)||this.dom.style[e]==i)},fixDisplay:function(){var j=this;a.fixDisplay.call(j);j.visibilityCls&&j.removeClass(j.visibilityCls)},isVisible:function(j){return this.visible||(!this.isStyle(g,c)&&this.visibilityCls?!this.hasClass(this.visibilityCls):!this.isStyle(e,i))}};Ext.override(h.Flyweight,f.El);Ext.ux.plugin.VisibilityMode=function(k){Ext.apply(this,k||{});var j=Ext.util.CSS;if(j&&!Ext.isIE&&this.fixMaximizedWindow!==false&&!Ext.ux.plugin.VisibilityMode.MaxWinFixed){j.updateRule(".x-window-maximized-ct","overflow","");Ext.ux.plugin.VisibilityMode.MaxWinFixed=true}};Ext.extend(Ext.ux.plugin.VisibilityMode,Object,{bubble:true,fixMaximizedWindow:true,elements:null,visibilityCls:"x-hide-nosize",hideMode:"nosize",ptype:"uxvismode",init:function(n){var k=this.hideMode||n.hideMode,m=this,j=Ext.Container.prototype.bubble,l=function(){var p=[this.collapseEl,this.actionMode].concat(m.elements||[]);Ext.each(p,function(q){m.extend(this[q]||q)},this);var o={visFixed:true,animCollapse:false,animFloat:false,hideMode:k,defaults:this.defaults||{}};o.defaults.hideMode=k;Ext.apply(this,o);Ext.apply(this.initialConfig||{},o)};n.on("render",function(){if(m.bubble!==false&&this.ownerCt){j.call(this.ownerCt,function(){this.visFixed||this.on("afterlayout",l,this,{single:true})})}l.call(this)},n,{single:true})},extend:function(j,k){j&&Ext.each([].concat(j),function(l){if(l&&l.dom){if("visibilityCls" in l){return}Ext.apply(l,f.El);l.visibilityCls=k||this.visibilityCls}},this);return this}});Ext.preg&&Ext.preg("uxvismode",Ext.ux.plugin.VisibilityMode);Ext.provide&&Ext.provide("uxvismode")})();(function(){var e=function(i,g){var h=i&&Ext.isObject(i)?{}:i;if(h&&Ext.isObject(h)){for(var j in i){(i[j]===null||i[j]===undefined)||(h[j]=i[j])}}return g?((h&&Ext.isObject(h))?Ext.urlEncode(h):encodeURI(h)):h};Ext.ns("Ext.ux.plugin");Ext.ux.Media=function(g){this.toString=this.asMarkup;Ext.apply(this,g||{});this.initMedia()};var b=Ext.ux.Media;var c=/4$/i;if(parseFloat(Ext.version)<2.1){throw"Ext.ux.Media and sub-classes are not License-Compatible with your Ext release."}Ext.ux.Media.prototype={hasVisModeFix:!!Ext.ux.plugin.VisibilityMode,mediaObject:null,mediaCfg:null,mediaVersion:null,requiredVersion:null,unsupportedText:null,hideMode:!Ext.isIE?"nosize":"display",animCollapse:Ext.enableFx&&Ext.isIE,animFloat:Ext.enableFx&&Ext.isIE,autoScroll:true,bodyStyle:{position:"relative"},initMedia:function(){},disableCaching:false,_maxPoll:200,getMediaType:function(g){return b.mediaTypes[g]},assert:function(g,h){g=typeof g==="function"?g.call(g.scope||null):g;return Ext.value(g,h)},assertId:function(h,g){h||(h=g||Ext.id());return h},prepareURL:function(i,k){var j=i?i.split("#"):[""];if(!!i&&(k=k===undefined?this.disableCaching:k)){var h=j[0];if(!(/_dc=/i).test(h)){var g="_dc="+(new Date().getTime());if(h.indexOf("?")!==-1){h+="&"+g}else{h+="?"+g}j[0]=h}}return j.length>1?j.join("#"):j[0]},prepareMedia:function(g,i,t,o){g=g||this.mediaCfg;if(!g){return""}var k=Ext.apply({url:false,autoSize:false},g);k.url=this.prepareURL(this.assert(k.url,false),k.disableCaching);if(k.mediaType){var r,u,h,l=Ext.Element.prototype;var j=Ext.apply({},this.getMediaType(this.assert(k.mediaType,false))||false);var n=e(Ext.apply(j.params||{},k.params||{}));for(var s in n){if(n.hasOwnProperty(s)){k.children||(k.children=[]);h=this.assert(n[s],null);
h&&(h=e(h,k.encodeParams!==false));u={tag:"param",name:s,value:h};(u.value==s)&&delete u.value;h&&k.children.push(u)}}delete j.params;var q=this.assert(k.unsupportedText||this.unsupportedText||j.unsupportedText,null);if(q){k.children||(k.children=[]);k.children.push(q)}if(k.style&&typeof k.style!="object"){throw"Style must be JSON formatted"}k.style=this.assert(Ext.apply(j.style||{},k.style||{}),{});delete j.style;k.height=this.assert(t||k.height||j.height||k.style.height,null);k.width=this.assert(i||k.width||j.width||k.style.width,null);k=Ext.apply({tag:"object"},k,j);if(k.height||k.autoSize){Ext.apply(k.style,{height:(Ext.Element.addUnits||l.addUnits).call(this.mediaEl,k.autoSize?"100%":k.height,l.defaultUnit||"px")})}if(k.width||k.autoSize){Ext.apply(k.style,{width:(Ext.Element.addUnits||l.addUnits).call(this.mediaEl,k.autoSize?"100%":k.width,l.defaultUnit||"px")})}k.id=this.assertId(k.id);k.name=this.assertId(k.name,k.id);k._macros={url:k.url||"",height:(/%$/.test(k.height))?k.height:parseInt(k.height,10)||null,width:(/%$/.test(k.width))?k.width:parseInt(k.width,10)||null,scripting:this.assert(k.scripting,false),controls:this.assert(k.controls,false),scale:this.assert(k.scale,1),status:this.assert(k.status,false),start:this.assert(k.start,false),loop:this.assert(k.loop,false),volume:this.assert(k.volume,20),id:k.id};delete k.url;delete k.mediaType;delete k.controls;delete k.status;delete k.start;delete k.loop;delete k.scale;delete k.scripting;delete k.volume;delete k.autoSize;delete k.autoScale;delete k.params;delete k.unsupportedText;delete k.renderOnResize;delete k.disableCaching;delete k.listeners;delete k.height;delete k.width;delete k.encodeParams;return k}else{var q=this.assert(k.unsupportedText||this.unsupportedText||j.unsupportedText,null);q=q?Ext.DomHelper.markup(q):null;return String.format(q||"Media Configuration/Plugin Error"," "," ")}},asMarkup:function(g){return this.mediaMarkup(this.prepareMedia(g))},mediaMarkup:function(j){j=j||this.mediaCfg;if(j){var i=j._macros;delete j._macros;var g=Ext.DomHelper.markup(j);if(i){var h,k;for(k in i){h=i[k];if(h!==null){g=g.replace(new RegExp("((%40|@)"+k+")","g"),h+"")}}}return g}},setMask:function(g){var h;if((h=this.mediaMask)){h.el||(h=this.mediaMask=new Ext.ux.IntelliMask(g,h));h.el.addClass("x-media-mask")}},refreshMedia:function(g){if(this.mediaCfg){this.renderMedia(null,g)}return this},renderMedia:function(m,i,l,g,j){if(!Ext.isReady){Ext.onReady(this.renderMedia.createDelegate(this,Array.prototype.slice.call(arguments,0)));return}var k=(this.mediaCfg=m||this.mediaCfg);i=Ext.get(this.lastCt||i||(this.mediaObject?this.mediaObject.dom.parentNode:null));this.onBeforeMedia.call(this,k,i,l,g,j);if(i){this.lastCt=i;if(k&&(k=this.prepareMedia(k,g,j,i))){this.setMask(i);this.mediaMask&&this.autoMask&&this.mediaMask.show();this.clearMedia().writeMedia(k,i,l||"afterbegin")}}this.onAfterMedia(i)},writeMedia:function(j,g,i){var h=Ext.get(g);if(h){i?Ext.DomHelper.insertHtml(i,h.dom,this.mediaMarkup(j)):h.update(this.mediaMarkup(j))}},clearMedia:function(){var g;if(Ext.isReady&&(g=this.mediaObject)){g.remove(true,true)}this.mediaObject=null;return this},resizeMedia:function(i,g,j){var k=this.mediaCfg;if(k&&this.boxReady&&k.renderOnResize&&(!!g||!!j)){if(arguments.length>3&&(!this.mediaObject||k.renderOnResize)){this.refreshMedia(this[this.mediaEl])}}},onBeforeMedia:function(n,j,l,k,h){var g=n||this.mediaCfg,i;if(g&&(i=this.getMediaType(g.mediaType))){g.autoSize=g.autoSize||i.autoSize===true;var o;if(g.autoSize&&(o=Ext.isReady?Ext.get(this[this.mediaEl]||this.lastCt||j):null)){g.height=this.autoHeight?null:o.getHeight(true);g.width=this.autoWidth?null:o.getWidth(true)}}this.assert(g.height,h);this.assert(g.width,k);n=g},onMediaLoad:function(g){if(g&&g.type=="load"){this.fireEvent("mediaload",this,this.mediaObject);if(this.mediaMask&&this.autoMask){this.mediaMask.hide()}}},onAfterMedia:function(h){var i;if(this.mediaCfg&&h&&(i=this.mediaObject=new (this.elementClass||Ext.ux.Media.Element)(h.child(".x-media",true)))&&i.dom){i.ownerCt=this;
var g;if(g=this.mediaCfg.listeners||null){i.on(g)}this.fireEvent("mediarender",this,this.mediaObject);if(i.dom.tagName!=="OBJECT"){i.on({load:this.onMediaLoad,scope:this,single:true})}else{this._countPoll=0;this.pollReadyState(this.onMediaLoad.createDelegate(this,[{type:"load"}],0))}}if(this.autoWidth||this.autoHeight){this.syncSize()}},pollReadyState:function(g,h){var i=this.getInterface();if(i&&"readyState" in i){(h||c).test(i.readyState)?g():arguments.callee.defer(10,this,arguments)}},getInterface:function(){return this.mediaObject?this.mediaObject.dom||null:null},detectVersion:Ext.emptyFn,autoMask:false};var f={init:function(){this.getId=function(){return this.id||(this.id="media-comp"+(++Ext.Component.AUTO_ID))};this.html=this.contentEl=this.items=null;if(this.hideMode=="nosize"){this.hasVisModeFix?new Ext.ux.plugin.VisibilityMode({elements:["bwrap","mediaEl"],hideMode:"nosize"}).init(this):(this.hideMode="display")}this.initMedia();this.toString=this.asMarkup;this.addEvents("mediarender","mediaload");if(this.mediaCfg.renderOnResize){this.on("resize",this.resizeMedia,this)}},afterRender:function(g){this.setMask(this[this.mediaEl]||g);f.setAutoScroll.call(this);if(!this.mediaCfg.renderOnResize){this.renderMedia(this.mediaCfg,this[this.mediaEl]||g)}},beforeDestroy:function(){this.clearMedia();Ext.destroy(this.mediaMask,this.loadMask);this.lastCt=this.mediaObject=this.renderTo=this.applyTo=this.mediaMask=this.loadMask=null},setAutoScroll:function(){if(this.rendered){this.getContentTarget().setOverflow(!!this.autoScroll?"auto":"hidden")}},getContentTarget:function(){return this[this.mediaEl]}};Ext.ux.Media.Component=Ext.extend(Ext.BoxComponent,{ctype:"Ext.ux.Media.Component",mediaEl:"el",autoScroll:true,autoEl:{tag:"div",style:{overflow:"hidden",display:"block",position:"relative"}},cls:"x-media-comp",mediaClass:Ext.ux.Media,constructor:function(g){Ext.apply(this,g,this.mediaClass.prototype);b.Component.superclass.constructor.apply(this,arguments)},initComponent:function(){b.Component.superclass.initComponent.apply(this,arguments);f.init.apply(this,arguments)},afterRender:function(g){b.Component.superclass.afterRender.apply(this,arguments);f.afterRender.apply(this,arguments)},beforeDestroy:function(){f.beforeDestroy.apply(this,arguments);this.rendered&&b.Component.superclass.beforeDestroy.apply(this,arguments)},doAutoLoad:Ext.emptyFn,getContentTarget:f.getContentTarget,setAutoScroll:f.setAutoScroll});Ext.reg("uxmedia",Ext.ux.Media.Component);Ext.reg("media",Ext.ux.Media.Component);Ext.ux.Media.Panel=Ext.extend(Ext.Panel,{cls:"x-media-panel",ctype:"Ext.ux.Media.Panel",autoScroll:false,mediaEl:"body",mediaClass:Ext.ux.Media,constructor:function(g){Ext.apply(this,this.mediaClass.prototype);b.Panel.superclass.constructor.apply(this,arguments)},initComponent:function(){b.Panel.superclass.initComponent.apply(this,arguments);f.init.apply(this,arguments)},afterRender:function(g){b.Panel.superclass.afterRender.apply(this,arguments);f.afterRender.apply(this,arguments)},beforeDestroy:function(){f.beforeDestroy.apply(this,arguments);this.rendered&&b.Panel.superclass.beforeDestroy.apply(this,arguments)},doAutoLoad:Ext.emptyFn,getContentTarget:f.getContentTarget,setAutoScroll:f.setAutoScroll});Ext.reg("mediapanel",Ext.ux.Media.Panel);Ext.ux.Media.Portlet=Ext.extend(Ext.ux.Media.Panel,{anchor:"100%",frame:true,collapseEl:"bwrap",collapsible:true,draggable:true,autoWidth:true,ctype:"Ext.ux.Media.Portlet",cls:"x-portlet x-media-portlet"});Ext.reg("mediaportlet",Ext.ux.Media.Portlet);Ext.ux.Media.Window=Ext.extend(Ext.Window,{constructor:function(){Ext.applyIf(this,this.mediaClass.prototype);b.Window.superclass.constructor.apply(this,arguments)},cls:"x-media-window",autoScroll:false,ctype:"Ext.ux.Media.Window",mediaClass:Ext.ux.Media,mediaEl:"body",initComponent:function(){b.Window.superclass.initComponent.apply(this,arguments);f.init.apply(this,arguments)},afterRender:function(){b.Window.superclass.afterRender.apply(this,arguments);f.afterRender.apply(this,arguments)
},beforeDestroy:function(){f.beforeDestroy.apply(this,arguments);this.rendered&&b.Window.superclass.beforeDestroy.apply(this,arguments)},doAutoLoad:Ext.emptyFn,getContentTarget:f.getContentTarget,setAutoScroll:f.setAutoScroll});Ext.reg("mediawindow",b.Window);Ext.ns("Ext.capabilities");Ext.ns("Ext.ux.Media.plugin");var a=(Ext.capabilities.hasAudio||(Ext.capabilities.hasAudio=function(){var i=!!document.createElement("audio").canPlayType,j=("Audio" in window)?new Audio(""):{},k=i||("canPlayType" in j)?{tag:i,object:("play" in j)}:false,l,h,g={mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/x-wav",basic:"audio/basic",aif:"audio/x-aiff"};if(k&&("canPlayType" in j)){for(h in g){k[h]=(l=j.canPlayType(g[h]))!="no"&&(l!="")}}return k}()));Ext.iterate||Ext.apply(Ext,{iterate:function(i,h,g){if(Ext.isEmpty(i)){return}if(Ext.isIterable(i)){Ext.each(i,h,g);return}else{if(Ext.isObject(i)){for(var j in i){if(i.hasOwnProperty(j)){if(h.call(g||i,j,i[j])===false){return}}}}}},isIterable:function(g){if(Ext.isArray(g)||g.callee){return true}if(/NodeList|HTMLCollection/.test(toString.call(g))){return true}return((g.nextNode||g.item)&&Ext.isNumber(g.length))},isObject:function(g){return g&&typeof g=="object"}});Ext.ux.Media.plugin.AudioEvents=Ext.extend(Ext.ux.Media.Component,{autoEl:{tag:"div"},cls:"x-hide-offsets",disableCaching:false,audioEvents:{},volume:0.5,ptype:"audioevents",initComponent:function(){this.mediaCfg||(this.mediaCfg={mediaType:"WAV",start:true,url:""});Ext.ux.Media.plugin.AudioEvents.superclass.initComponent.apply(this,arguments);this.addEvents("beforeaudio");this.setVolume(this.volume)},init:function(h){this.rendered||this.render(Ext.getBody());if(h.dom||h.ctype){var g=this;Ext.iterate(this.audioEvents||{},function(i){if(h.events&&!h.events[i]){return}Ext.applyIf(h,{audioPlugin:g,audioListeners:{},removeAudioListener:function(j){if(j&&this.audioListeners[j]){this.removeListener&&this.removeListener(j,this.audioListeners[j],this);delete this.audioListeners[j]}},removeAudioListeners:function(){var j=[];Ext.iterate(this.audioListeners,function(k){j.push(k)});Ext.iterate(j,this.removeAudioListener,this)},addAudioListener:function(j){if(this.audioListeners[j]){this.removeAudioListener(j)}this.addListener&&this.addListener(j,this.audioListeners[j]=function(){this.audioPlugin.onEvent(this,j)},this)},enableAudio:function(){this.audioPlugin&&this.audioPlugin.enable()},disableAudio:function(){this.audioPlugin&&this.audioPlugin.disable()},setVolume:function(j){this.audioPlugin&&this.audioPlugin.setVolume(j)}});h.addAudioListener(i)},this)}},setVolume:function(i){var h=this.audioObject,g=Math.max(Math.min(parseFloat(i)||0,1),0);this.mediaCfg&&(this.mediaCfg.volume=g*100);this.volume=g;h&&(h.volume=g);return this},onEvent:function(g,h){if(!this.disabled&&this.audioEvents&&this.audioEvents[h]){if(this.fireEvent("beforeaudio",this,g,h)!==false){this.mediaCfg.url=this.audioEvents[h];if(a.object){this.audioObject&&this.audioObject.stop&&this.audioObject.stop();if(this.audioObject=new Audio(this.mediaCfg.url||"")){this.setVolume(this.volume);this.audioObject.play&&this.audioObject.play()}}else{var i=this.getInterface();if(i){if(i.object){i=i.object;("Open" in i)&&i.Open(this.mediaCfg.url||"");("Play" in i)&&i.Play()}else{this.refreshMedia()}}}}}}});Ext.preg&&Ext.preg("audioevents",Ext.ux.Media.plugin.AudioEvents);Ext.onReady(function(){var g=Ext.util.CSS,h=[];g.getRule(".x-media",true)||(h.push(".x-media{width:100%;height:100%;outline:none;overflow:hidden;}"));g.getRule(".x-media-mask")||(h.push(".x-media-mask{width:100%;height:100%;overflow:hidden;position:relative;zoom:1;}"));g.getRule(".x-media-img")||(h.push(".x-media-img{background-color:transparent;width:auto;height:auto;position:relative;}"));g.getRule(".x-masked-relative")||(h.push(".x-masked-relative{position:relative!important;}"));if(!!h.length){g.createStyleSheet(h.join(""));g.refreshCache()}});Ext.override(Ext.Element,{mask:function(h,g){if(this.getStyle("position")=="static"){this.addClass("x-masked-relative")
}this._mask||(this._mask=Ext.DomHelper.append(this.dom,{cls:"ext-el-mask"},true));if(!this.select("iframe,frame,object,embed").elements.length){this.addClass("x-masked")}this._mask.setDisplayed(true);if(typeof h=="string"){this._maskMsg||(this._maskMsg=Ext.DomHelper.append(this.dom,{style:"visibility:hidden",cls:g?"ext-el-mask-msg "+g:"ext-el-mask-msg",cn:{tag:"div",html:h}},true));this._maskMsg.center(this).setVisible(true)}if(Ext.isIE&&!(Ext.isIE7&&Ext.isStrict)&&this.getStyle("height")=="auto"){this._mask.setSize(undefined,this.getHeight())}return this._mask},unmask:function(g){if(this._maskMsg){this._maskMsg.setVisible(false);if(g!==false){this._maskMsg.remove(true);delete this._maskMsg}}if(this._mask){this._mask.setDisplayed(false);if(g!==false){this._mask.remove(true);delete this._mask}}this.removeClass(["x-masked","x-masked-relative"])},remove:function(h,g){if(this.dom){this.unmask(true);this.removeAllListeners();if(h){this.cleanse(true,g)}Ext.removeNode(this.dom);this.dom=null}},cleanse:function(h,i){if(this.isCleansed&&h!==true){return this}var j=this.dom,k=j.firstChild,g;while(j&&k){g=k.nextSibling;if(i){Ext.fly(k,"_cleanser").cleanse(h,i)}Ext.removeNode(k);k=g}delete Ext.Element._flyweights._cleanser;this.isCleansed=true;return this}});Ext.ux.Media.Element=Ext.extend(Ext.Element,{constructor:function(g){if(!g){return null}var h=typeof g=="string"?d.getElementById(g):g.dom||g;if(!h){return null}this.dom=h;this.id=h.id||Ext.id(h);Ext.Element.cache[this.id]=this},mask:function(h,g){this.maskEl||(this.maskEl=this.parent(".x-media-mask")||this.parent());return this.maskEl.mask.apply(this.maskEl,arguments)},unmask:function(g){if(this.maskEl){this.maskEl.unmask(g);this.maskEl=null}}});Ext.ux.Media.prototype.elementClass=Ext.ux.Media.Element;Ext.ux.IntelliMask=function(h,g){Ext.apply(this,g);this.el=Ext.get(h)};Ext.ux.IntelliMask.prototype={removeMask:false,msg:"Loading Media...",msgCls:"x-mask-loading",zIndex:null,disabled:false,active:false,autoHide:false,disable:function(){this.disabled=true},enable:function(){this.disabled=false},show:function(m,l,k,i){var j={},g=this.autoHide;i=parseInt(i,10)||20;if(typeof m=="object"){j=m;m=j.msg;l=j.msgCls;k=j.fn;g=typeof j.autoHide!="undefined"?j.autoHide:g;i=j.fnDelay||i}if(!this.active&&!this.disabled&&this.el){var h=this.el.mask(m||this.msg,l||this.msgCls);this.active=!!this.el._mask;if(this.active){if(this.zIndex){this.el._mask.setStyle("z-index",this.zIndex);if(this.el._maskMsg){this.el._maskMsg.setStyle("z-index",this.zIndex+1)}}}}else{i=0}if(typeof k==="function"){k.defer(i,j.scope||null)}else{i=0}if(g&&(g=parseInt(g,10)||2000)){this.hide.defer(g+(i||0),this)}return this.active?{mask:this.el._mask,maskMsg:this.el._maskMsg}:null},hide:function(g){if(this.el){this.el.unmask(g||this.removeMask)}this.active=false;return this},destroy:function(){this.hide(true);this.el=null}};Ext.ux.Media.mediaTypes={WAV:Ext.apply({tag:"object",cls:"x-media x-media-wav",data:"@url",type:"audio/x-wav",loop:false,params:{filename:"@url",displaysize:0,autostart:"@start",showControls:"@controls",showStatusBar:false,showaudiocontrols:"@controls",stretchToFit:false,Volume:"@volume",PlayCount:1}},Ext.isIE?{classid:"CLSID:22d6f312-b0f6-11d0-94ab-0080c74c7e95",codebase:"http"+((Ext.isSecure)?"s":"")+"://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701",type:"application/x-oleobject"}:{src:"@url"}),PDF:Ext.apply({tag:"object",cls:"x-media x-media-pdf",type:"application/pdf",data:"@url",autoSize:true,params:{src:"@url"}},Ext.isIE?{classid:"CLSID:CA8A9780-280D-11CF-A24D-444553540000"}:false),PDFFRAME:{tag:"iframe",cls:"x-media x-media-pdf-frame",frameBorder:0,style:{"z-index":2},src:"@url",autoSize:true},WMV:Ext.apply({tag:"object",cls:"x-media x-media-wmv",type:"application/x-mplayer2",data:"@url",autoSize:true,params:{filename:"@url",displaysize:0,autostart:"@start",showControls:"@controls",showStatusBar:"@status",showaudiocontrols:true,stretchToFit:true,Volume:"@volume",PlayCount:1}},Ext.isIE?{classid:"CLSID:22d6f312-b0f6-11d0-94ab-0080c74c7e95",codebase:"http"+((Ext.isSecure)?"s":"")+"://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701",type:"application/x-oleobject"}:{src:"@url"}),APPLET:{tag:"object",cls:"x-media x-media-applet",type:"application/x-java-applet",unsupportedText:{tag:"p",html:"Java is not installed/enabled."},params:{url:"@url",archive:"",code:""}},"AUDIO-OGG":{tag:"audio",controls:"@controls",src:"@url"},"VIDEO-OGG":{tag:"video",controls:"@controls",src:"@url"},SWF:Ext.apply({tag:"object",cls:"x-media x-media-swf",type:"application/x-shockwave-flash",scripting:"sameDomain",standby:"Loading..",loop:true,start:false,unsupportedText:{cn:["The Adobe Flash Player is required.",{tag:"br"},{tag:"a",cn:[{tag:"img",src:"http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif"}],href:"http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash",target:"_flash"}]},params:{movie:"@url",menu:"@controls",play:"@start",quality:"high",allowscriptaccess:"@scripting",allownetworking:"all",allowfullScreen:false,bgcolor:"#FFFFFF",wmode:"opaque",loop:"@loop"}},Ext.isIE?{classid:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",codebase:"http"+((Ext.isSecure)?"s":"")+"://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0"}:{data:"@url"}),SCRIBD:Ext.apply({tag:"object",cls:"x-media x-media-scribd",type:"application/x-shockwave-flash",scripting:"always",standby:"Loading..",loop:true,start:false,unsupportedText:{cn:["The Adobe Flash Player is required.",{tag:"br"},{tag:"a",cn:[{tag:"img",src:"http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif"}],href:"http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash",target:"_flash"}]},params:{movie:"@url",menu:"@controls",play:"@start",quality:"high",menu:true,scale:"showall",salign:" ",allowscriptaccess:"@scripting",allownetworking:"all",allowfullScreen:true,bgcolor:"#FFFFFF",wmode:"opaque",loop:"@loop"}},Ext.isIE?{classid:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",codebase:"http"+((Ext.isSecure)?"s":"")+"://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0"}:{data:"@url"}),JWP:Ext.apply({tag:"object",cls:"x-media x-media-swf x-media-flv",type:"application/x-shockwave-flash",data:"@url",loop:false,start:false,boundExternals:["sendEvent","addModelListener","addControllerListener","addViewListener","getConfig","getPlaylist"],params:{movie:"@url",flashVars:{autostart:"@start",repeat:"@loop",height:"@height",width:"@width",id:"@id"}}},Ext.isIE?{classid:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",codebase:"http"+((Ext.isSecure)?"s":"")+"://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0"}:false),QT:Ext.apply({tag:"object",cls:"x-media x-media-quicktime",type:"video/quicktime",style:{position:"relative","z-index":1,behavior:"url(#qt_event_source)"},scale:"aspect",unsupportedText:'<a href="http://www.apple.com/quicktime/download/">Get QuickTime</a>',scripting:true,volume:"50%",data:"@url",params:{src:Ext.isIE?"@url":null,href:"http://quicktime.com",target:"_blank",autoplay:"@start",targetcache:true,cache:true,wmode:"opaque",controller:"@controls",enablejavascript:"@scripting",loop:"@loop",scale:"@scale",volume:"@volume",QTSRC:"@url"}},Ext.isIE?{classid:"clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B",codebase:"http"+((Ext.isSecure)?"s":"")+"://www.apple.com/qtactivex/qtplugin.cab#version=7,2,1,0"}:{PLUGINSPAGE:"http://www.apple.com/quicktime/download/"}),QTEVENTS:{tag:"object",id:"qt_event_source",cls:"x-media x-media-qtevents",type:"video/quicktime",params:{},classid:"clsid:CB927D12-4FF7-4a9e-A169-56E4B8A75598",codebase:"http"+((Ext.isSecure)?"s":"")+"://www.apple.com/qtactivex/qtplugin.cab#version=7,2,1,0"},WPMP3:Ext.apply({tag:"object",cls:"x-media x-media-audio x-media-wordpress",type:"application/x-shockwave-flash",data:"@url",start:true,loop:false,boundExternals:["open","close","setVolume","load"],params:{movie:"@url",width:"@width",flashVars:{autostart:"@start",controller:"@controls",enablejavascript:"@scripting",loop:"@loop",scale:"@scale",initialvolume:"@volume",width:"@width",encode:"no",soundFile:""}}},Ext.isIE?{classid:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"}:false),REAL:Ext.apply({tag:"object",cls:"x-media x-media-real",type:"audio/x-pn-realaudio-plugin",data:"@url",controls:"all",start:-1,standby:"Loading Real Media Player components...",params:{src:"@url",autostart:"@start",center:false,maintainaspect:true,prefetch:false,controller:"@controls",controls:"@controls",volume:"@volume",loop:"@loop",numloop:null,shuffle:false,console:"_master",backgroundcolor:"#000000"}},Ext.isIE?{classid:"clsid:CFCDAA03-8BE4-11CF-B84B-0020AFBBCCFA"}:false),SVG:{tag:"object",cls:"x-media x-media-img x-media-svg",type:"image/svg+xml",data:"@url",params:{src:"@url"}},GIF:{tag:"img",cls:"x-media x-media-img x-media-gif",src:"@url"},TIFF:{tag:"object",type:"image/tiff",cls:"x-media x-media-img x-media-tiff",data:"@url"},JPEG:{tag:"img",cls:"x-media x-media-img x-media-jpeg",src:"@url"},JP2:{tag:"object",cls:"x-media x-media-img x-media-jp2",type:Ext.isIE?"image/jpeg2000-image":"image/jp2",data:"@url"},PNG:{tag:"img",cls:"x-media x-media-img x-media-png",src:"@url"},HTM:{tag:"iframe",cls:"x-media x-media-html",frameBorder:0,autoSize:true,style:{overflow:"auto","z-index":2},src:"@url"},TXT:{tag:"object",cls:"x-media x-media-text",type:"text/plain",style:{overflow:"auto",width:"100%",height:"100%"},data:"@url"},RTF:{tag:"object",cls:"x-media x-media-rtf",type:"application/rtf",style:{overflow:"auto",width:"100%",height:"100%"},data:"@url"},JS:{tag:"object",cls:"x-media x-media-js",type:"text/javascript",style:{overflow:"auto",width:"100%",height:"100%"},data:"@url"},CSS:{tag:"object",cls:"x-media x-media-css",type:"text/css",style:{overflow:"auto",width:"100%",height:"100%"},data:"@url"},SILVERLIGHT:{tag:"object",cls:"x-media x-media-silverlight",type:"application/ag-plugin",data:"@url",params:{MinRuntimeVersion:"1.0",source:"@url"}},SILVERLIGHT2:{tag:"object",cls:"x-media x-media-silverlight",type:"application/x-silverlight-2",data:"data:application/x-silverlight,",params:{MinRuntimeVersion:"2.0"},unsupportedText:'<a href="http://go2.microsoft.com/fwlink/?LinkID=114576&v=2.0"><img style="border-width: 0pt;" alt="Get Microsoft Silverlight" src="http://go2.microsoft.com/fwlink/?LinkID=108181"/></a>'},XML:{tag:"iframe",cls:"x-media x-media-xml",style:{overflow:"auto"},src:"@url"},VLC:Ext.apply({tag:"object",cls:"x-media x-media-vlc",type:"application/x-google-vlc-plugin",pluginspage:"http://www.videolan.org",events:true,start:false,params:{Src:"@url",MRL:"@url",autoplay:"@start",ShowDisplay:"@controls",Volume:"@volume",Autoloop:"@loop"}},Ext.isIE?{classid:"clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921",CODEBASE:"http"+((Ext.isSecure)?"s":"")+"://downloads.videolan.org/pub/videolan/vlc/latest/win32/axvlc.cab"}:{target:"@url"}),ODT:Ext.apply({tag:"object",cls:"x-media x-media-odt",type:"application/vnd.oasis.opendocument.text",data:"@url",params:{src:"@url"}},Ext.isIE?{classid:"clsid:67F2A879-82D5-4A6D-8CC5-FFB3C114B69D"}:false),ODS:Ext.apply({tag:"object",cls:"x-media x-media-odt",type:"application/vnd.oasis.opendocument.spreadsheet",data:"@url",params:{src:"@url"}},Ext.isIE?{classid:"clsid:67F2A879-82D5-4A6D-8CC5-FFB3C114B69D"}:false),IMPRESS:Ext.apply({tag:"object",cls:"x-media x-media-sxi",start:false,type:"application/vnd.sun.xml.impress",data:"@url",params:{wmode:"transparent",src:Ext.isIE?"@url":null}},Ext.isIE?{classid:"clsid:67F2A879-82D5-4A6D-8CC5-FFB3C114B69D"}:{data:"@url"})};
if(Ext.provide){Ext.provide("uxmedia")}Ext.applyIf(Array.prototype,{map:function(h,l){var g=this.length;if(typeof h!="function"){throw new TypeError()}var k=new Array(g);for(var j=0;j<g;j++){if(j in this){k[j]=h.call(l||this,this[j],j,this)}}return k}});Ext.ux.MediaComponent=Ext.ux.Media.Component;Ext.ux.MediaPanel=Ext.ux.Media.Panel;Ext.ux.MediaPortlet=Ext.ux.Media.Portlet;Ext.ux.MediaWindow=Ext.ux.Media.Window})();/*
 * Ext JS Library 3.3.1
 * Copyright(c) 2006-2010 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.namespace("Ext.ux");Ext.ux.StartMenu=Ext.extend(Ext.menu.Menu,{initComponent:function(a){Ext.ux.StartMenu.superclass.initComponent.call(this,a);var b=this.toolItems;this.toolItems=new Ext.util.MixedCollection();if(b){this.addTool.apply(this,b)}},onRender:function(h,g){Ext.ux.StartMenu.superclass.onRender.call(this,h,g);var a=this.el.addClass("ux-start-menu");var e=a.createChild({tag:"div",cls:"x-window-header x-unselectable x-panel-icon "+this.iconCls});this.header=e;var f=e.createChild({tag:"span",cls:"x-window-header-text"});var o=e.wrap({cls:"ux-start-menu-tl"});var k=e.wrap({cls:"ux-start-menu-tr"});var c=e.wrap({cls:"ux-start-menu-tc"});this.menuBWrap=a.createChild({tag:"div",cls:"x-window-body x-border-layout-ct ux-start-menu-body"});var d=this.menuBWrap.wrap({cls:"ux-start-menu-ml"});var l=this.menuBWrap.wrap({cls:"x-window-mc ux-start-menu-bwrap"});this.menuPanel=this.menuBWrap.createChild({tag:"div",cls:"x-panel x-border-panel ux-start-menu-apps-panel"});this.toolsPanel=this.menuBWrap.createChild({tag:"div",cls:"x-panel x-border-panel ux-start-menu-tools-panel"});var j=d.wrap({cls:"x-window-bwrap"});var i=j.createChild({tag:"div",cls:"ux-start-menu-bc"});var b=i.wrap({cls:"ux-start-menu-bl x-panel-nofooter"});var n=i.wrap({cls:"ux-start-menu-br"});this.ul.appendTo(this.menuPanel);var m=this.toolsPanel.createChild({tag:"ul",cls:"x-menu-list"});this.mon(m,"click",this.onClick,this);this.mon(m,"mouseover",this.onMouseOver,this);this.mon(m,"mouseout",this.onMouseOut,this);this.items.each(function(p){p.parentMenu=this},this);this.toolItems.each(function(q){var p=document.createElement("li");p.className="x-menu-list-item";m.dom.appendChild(p);q.render(p);q.parentMenu=this},this);this.toolsUl=m;this.menuBWrap.setStyle("position","relative");this.menuBWrap.setHeight(this.height-28);this.menuPanel.setStyle({padding:"2px",position:"absolute",overflow:"auto"});this.toolsPanel.setStyle({padding:"2px 4px 2px 2px",position:"absolute",overflow:"auto"});this.setTitle(this.title)},findTargetItem:function(b){var a=b.getTarget(".x-menu-list-item",this.ul,true);if(a&&a.menuItemId){if(this.items.get(a.menuItemId)){return this.items.get(a.menuItemId)}else{return this.toolItems.get(a.menuItemId)}}},show:function(b,e,a){this.parentMenu=a;if(!this.el){this.render()}this.fireEvent("beforeshow",this);this.showAt(this.el.getAlignToXY(b,e||this.defaultAlign),a,false);var d=100;var c=this.menuBWrap.getBox();this.menuPanel.setWidth(c.width-d);this.menuPanel.setHeight(c.height);this.toolsPanel.setWidth(d);this.toolsPanel.setX(c.x+c.width-d);this.toolsPanel.setHeight(c.height)},addTool:function(){var c=arguments,b=c.length,f;for(var d=0;d<b;d++){var e=c[d];if(e.render){f=this.addToolItem(e)}else{if(typeof e=="string"){if(e=="separator"||e=="-"){f=this.addToolSeparator()}else{f=this.addText(e)}}else{if(e.tagName||e.el){f=this.addElement(e)}else{if(typeof e=="object"){f=this.addToolMenuItem(e)}}}}}return f},addToolSeparator:function(){return this.addToolItem(new Ext.menu.Separator({itemCls:"ux-toolmenu-sep"}))},addToolItem:function(b){this.toolItems.add(b);if(this.ul){var a=document.createElement("li");a.className="x-menu-list-item";this.ul.dom.appendChild(a);b.render(a,this);this.delayAutoWidth()}return b},addToolMenuItem:function(a){if(!(a instanceof Ext.menu.Item)){if(typeof a.checked=="boolean"){a=new Ext.menu.CheckItem(a)}else{a=new Ext.menu.Item(a)}}return this.addToolItem(a)},setTitle:function(b,a){this.title=b;this.header.child("span").update(b);return this}});/*
 * Ext JS Library 3.3.1
 * Copyright(c) 2006-2010 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.ux.TaskBar=function(a){this.app=a;this.init()};Ext.extend(Ext.ux.TaskBar,Ext.util.Observable,{init:function(){this.startMenu=new Ext.ux.StartMenu(Ext.apply({iconCls:"user",height:300,shadow:true,width:300},this.app.startConfig));this.startBtn=new Ext.Button({text:"Finder",id:"ux-startbutton",iconCls:"start",menu:this.startMenu,menuAlign:"bl-tl",renderTo:"ux-taskbar-start",clickEvent:"mousedown",template:new Ext.Template('<table cellspacing="0" class="x-btn"><tbody class="{1}"><tr>','<td class="ux-startbutton-left"><i>&#160;</i></td>','<td class="ux-startbutton-center"><em class="{2} unselectable="on">','<button class="x-btn-text" type="{0}" style="height:30px;"></button>',"</em></td>",'<td class="ux-startbutton-right"><i>&#160;</i></td>',"</tr></tbody></table>")});var c=this.startBtn.getEl().getWidth()+10;var b=new Ext.BoxComponent({el:"ux-taskbar-start",id:"TaskBarStart",minWidth:c,region:"west",split:true,width:c});this.tbPanel=new Ext.ux.TaskButtonsPanel({el:"ux-taskbuttons-panel",id:"TaskBarButtons",region:"center"});var a=new Ext.ux.TaskBarContainer({el:"ux-taskbar",layout:"border",items:[b,this.tbPanel]});return this},addTaskButton:function(a){return this.tbPanel.addButton(a,"ux-taskbuttons-panel")},removeTaskButton:function(a){this.tbPanel.removeButton(a)},setActiveButton:function(a){this.tbPanel.setActiveButton(a)}});Ext.ux.TaskBarContainer=Ext.extend(Ext.Container,{initComponent:function(){Ext.ux.TaskBarContainer.superclass.initComponent.call(this);this.el=Ext.get(this.el)||Ext.getBody();this.el.setHeight=Ext.emptyFn;this.el.setWidth=Ext.emptyFn;this.el.setSize=Ext.emptyFn;this.el.setStyle({overflow:"hidden",margin:"0",border:"0 none"});this.el.dom.scroll="no";this.allowDomMove=false;this.autoWidth=true;this.autoHeight=true;Ext.EventManager.onWindowResize(this.fireResize,this);this.renderTo=this.el},fireResize:function(a,b){this.onResize(a,b,a,b);this.fireEvent("resize",this,a,b,a,b)}});Ext.ux.TaskButtonsPanel=Ext.extend(Ext.BoxComponent,{activeButton:null,enableScroll:true,scrollIncrement:0,scrollRepeatInterval:400,scrollDuration:0.35,animScroll:true,resizeButtons:true,buttonWidth:168,minButtonWidth:118,buttonMargin:2,buttonWidthSet:false,initComponent:function(){Ext.ux.TaskButtonsPanel.superclass.initComponent.call(this);this.on("resize",this.delegateUpdates);this.items=[];this.stripWrap=Ext.get(this.el).createChild({cls:"ux-taskbuttons-strip-wrap",cn:{tag:"ul",cls:"ux-taskbuttons-strip"}});this.stripSpacer=Ext.get(this.el).createChild({cls:"ux-taskbuttons-strip-spacer"});this.strip=new Ext.Element(this.stripWrap.dom.firstChild);this.edge=this.strip.createChild({tag:"li",cls:"ux-taskbuttons-edge"});this.strip.createChild({cls:"x-clear"})},addButton:function(c){var a=this.strip.createChild({tag:"li"},this.edge);var b=new Ext.ux.TaskBar.TaskButton(c,a);this.items.push(b);if(!this.buttonWidthSet){this.lastButtonWidth=b.container.getWidth()}this.setActiveButton(b);return b},removeButton:function(d){var b=document.getElementById(d.container.id);d.destroy();b.parentNode.removeChild(b);var e=[];for(var c=0,a=this.items.length;c<a;c++){if(this.items[c]!=d){e.push(this.items[c])}}this.items=e;this.delegateUpdates()},setActiveButton:function(a){this.activeButton=a;this.delegateUpdates()},delegateUpdates:function(){if(this.resizeButtons&&this.rendered){this.autoSize()}if(this.enableScroll&&this.rendered){this.autoScroll()}},autoSize:function(){var h=this.items.length;var c=this.el.dom.offsetWidth;var a=this.el.dom.clientWidth;if(!this.resizeButtons||h<1||!a){return}var k=Math.max(Math.min(Math.floor((a-4)/h)-this.buttonMargin,this.buttonWidth),this.minButtonWidth);var e=this.stripWrap.dom.getElementsByTagName("button");this.lastButtonWidth=Ext.get(e[0].id).findParent("li").offsetWidth;for(var f=0,j=e.length;f<j;f++){var b=e[f];var g=Ext.get(e[f].id).findParent("li").offsetWidth;var d=b.offsetWidth;b.style.width=(k-(g-d))+"px"
}},autoScroll:function(){var f=this.items.length;var d=this.el.dom.offsetWidth;var c=this.el.dom.clientWidth;var e=this.stripWrap;var b=e.dom.offsetWidth;var g=this.getScrollPos();var a=this.edge.getOffsetsTo(this.stripWrap)[0]+g;if(!this.enableScroll||f<1||b<20){return}e.setWidth(c);if(a<=c){e.dom.scrollLeft=0;if(this.scrolling){this.scrolling=false;this.el.removeClass("x-taskbuttons-scrolling");this.scrollLeft.hide();this.scrollRight.hide()}}else{if(!this.scrolling){this.el.addClass("x-taskbuttons-scrolling")}c-=e.getMargins("lr");e.setWidth(c>20?c:20);if(!this.scrolling){if(!this.scrollLeft){this.createScrollers()}else{this.scrollLeft.show();this.scrollRight.show()}}this.scrolling=true;if(g>(a-c)){e.dom.scrollLeft=a-c}else{this.scrollToButton(this.activeButton,true)}this.updateScrollButtons()}},createScrollers:function(){var c=this.el.dom.offsetHeight;var a=this.el.insertFirst({cls:"ux-taskbuttons-scroller-left"});a.setHeight(c);a.addClassOnOver("ux-taskbuttons-scroller-left-over");this.leftRepeater=new Ext.util.ClickRepeater(a,{interval:this.scrollRepeatInterval,handler:this.onScrollLeft,scope:this});this.scrollLeft=a;var b=this.el.insertFirst({cls:"ux-taskbuttons-scroller-right"});b.setHeight(c);b.addClassOnOver("ux-taskbuttons-scroller-right-over");this.rightRepeater=new Ext.util.ClickRepeater(b,{interval:this.scrollRepeatInterval,handler:this.onScrollRight,scope:this});this.scrollRight=b},getScrollWidth:function(){return this.edge.getOffsetsTo(this.stripWrap)[0]+this.getScrollPos()},getScrollPos:function(){return parseInt(this.stripWrap.dom.scrollLeft,10)||0},getScrollArea:function(){return parseInt(this.stripWrap.dom.clientWidth,10)||0},getScrollAnim:function(){return{duration:this.scrollDuration,callback:this.updateScrollButtons,scope:this}},getScrollIncrement:function(){return(this.scrollIncrement||this.lastButtonWidth+2)},scrollToButton:function(e,a){e=e.el.dom.parentNode;if(!e){return}var c=e;var g=this.getScrollPos(),d=this.getScrollArea();var f=Ext.fly(c).getOffsetsTo(this.stripWrap)[0]+g;var b=f+c.offsetWidth;if(f<g){this.scrollTo(f,a)}else{if(b>(g+d)){this.scrollTo(b-d,a)}}},scrollTo:function(b,a){this.stripWrap.scrollTo("left",b,a?this.getScrollAnim():false);if(!a){this.updateScrollButtons()}},onScrollRight:function(){var a=this.getScrollWidth()-this.getScrollArea();var c=this.getScrollPos();var b=Math.min(a,c+this.getScrollIncrement());if(b!=c){this.scrollTo(b,this.animScroll)}},onScrollLeft:function(){var b=this.getScrollPos();var a=Math.max(0,b-this.getScrollIncrement());if(a!=b){this.scrollTo(a,this.animScroll)}},updateScrollButtons:function(){var a=this.getScrollPos();this.scrollLeft[a==0?"addClass":"removeClass"]("ux-taskbuttons-scroller-left-disabled");this.scrollRight[a>=(this.getScrollWidth()-this.getScrollArea())?"addClass":"removeClass"]("ux-taskbuttons-scroller-right-disabled")}});Ext.ux.TaskBar.TaskButton=function(b,a){this.win=b;Ext.ux.TaskBar.TaskButton.superclass.constructor.call(this,{iconCls:b.iconCls,text:Ext.util.Format.ellipsis(b.title,12),renderTo:a,handler:function(){if(b.minimized||b.hidden){b.show()}else{if(b==b.manager.getActive()){b.minimize()}else{b.toFront()}}},clickEvent:"mousedown",template:new Ext.Template('<table cellspacing="0" class="x-btn {3}"><tbody><tr>','<td class="ux-taskbutton-left"><i>&#160;</i></td>','<td class="ux-taskbutton-center"><em class="{5} unselectable="on">','<button class="x-btn-text {2}" type="{1}" style="height:28px;">{0}</button>',"</em></td>",'<td class="ux-taskbutton-right"><i>&#160;</i></td>',"</tr></tbody></table>")})};Ext.extend(Ext.ux.TaskBar.TaskButton,Ext.Button,{onRender:function(){Ext.ux.TaskBar.TaskButton.superclass.onRender.apply(this,arguments);this.cmenu=new Ext.menu.Menu({items:[{text:"Restore",handler:function(){if(!this.win.isVisible()){this.win.show()}else{this.win.restore()}},scope:this},{text:"Minimize",handler:this.win.minimize,scope:this.win},{text:"Maximize",handler:this.win.maximize,scope:this.win},"-",{text:"Close",handler:this.closeWin.createDelegate(this,this.win,true),scope:this.win}]});
this.cmenu.on("beforeshow",function(){var b=this.cmenu.items.items;var a=this.win;b[0].setDisabled(a.maximized!==true&&a.hidden!==true);b[1].setDisabled(a.minimized===true);b[2].setDisabled(a.maximized===true||a.hidden===true)},this);this.el.on("contextmenu",function(b){b.stopEvent();if(!this.cmenu.el){this.cmenu.render()}var a=b.getXY();a[1]-=this.cmenu.el.getHeight();this.cmenu.showAt(a)},this)},closeWin:function(a,c,b){if(!b.isVisible()){b.show()}else{b.restore()}b.close()}});/*
 * Ext JS Library 3.3.1
 * Copyright(c) 2006-2010 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.Desktop=function(b){this.taskbar=new Ext.ux.TaskBar(b);this.xTickSize=this.yTickSize=1;var g=this.taskbar;var l=Ext.get("x-desktop");var d=Ext.get("ux-taskbar");var i=Ext.get("x-shortcuts");var j=new Ext.WindowGroup();var f;function a(n){g.startMenu.setTitle(n)}function e(n){n.minimized=true;n.hide()}function k(o){if(f&&f!=o){if(!f.maximized&&!o.maximized&&!o.minimized){var n=f.getPosition()[0];var p=f.getPosition()[1];o.setPosition(n+20,p+20)}m(f)}g.setActiveButton(o.taskButton);f=o;Ext.fly(o.taskButton.el).addClass("active-win");o.minimized=false}function m(n){if(n==f){f=null;Ext.fly(n.taskButton.el).removeClass("active-win")}}function c(n){g.removeTaskButton(n.taskButton);h()}function h(){l.setHeight(Ext.lib.Dom.getViewHeight()-d.getHeight())}Ext.EventManager.onWindowResize(h);this.layout=h;this.createWindow=function(o,n){var p=new (n||Ext.Window)(Ext.applyIf(o||{},{renderTo:l,manager:j,minimizable:true,maximizable:true}));p.dd.xTickSize=this.xTickSize;p.dd.yTickSize=this.yTickSize;if(p.resizer){p.resizer.widthIncrement=this.xTickSize;p.resizer.heightIncrement=this.yTickSize}p.render(l);p.taskButton=g.addTaskButton(p);p.cmenu=new Ext.menu.Menu({items:[]});p.animateTarget=p.taskButton.el;p.on({activate:{fn:k},beforeshow:{fn:k},deactivate:{fn:m},minimize:{fn:e},close:{fn:c}});h();return p};this.getManager=function(){return j};this.getWindow=function(n){return j.get(n)};this.getWinWidth=function(){var n=Ext.lib.Dom.getViewWidth();return n<200?200:n};this.getWinHeight=function(){var n=(Ext.lib.Dom.getViewHeight()-d.getHeight());return n<100?100:n};this.getWinX=function(n){return(Ext.lib.Dom.getViewWidth()-n)/2};this.getWinY=function(n){return(Ext.lib.Dom.getViewHeight()-d.getHeight()-n)/2};this.setTickSize=function(n,o){this.xTickSize=n;if(arguments.length==1){this.yTickSize=n}else{this.yTickSize=o}j.each(function(p){p.dd.xTickSize=this.xTickSize;p.dd.yTickSize=this.yTickSize;p.resizer.widthIncrement=this.xTickSize;p.resizer.heightIncrement=this.yTickSize},this)};this.cascade=function(){var n=0,o=0;j.each(function(p){if(p.isVisible()&&!p.maximized){p.setPosition(n,o);n+=20;o+=20}},this)};this.closeAllWindows=function(){var n=0,o=0;j.each(function(p){p.close()},this)};this.tile=function(){var q=l.getWidth(true);var n=this.xTickSize;var p=this.yTickSize;var o=p;j.each(function(s){if(s.isVisible()&&!s.maximized){var r=s.el.getWidth();if((n>this.xTickSize)&&(n+r>q)){n=this.xTickSize;p=o}s.setPosition(n,p);n+=r+this.xTickSize;o=Math.max(o,p+s.el.getHeight()+this.yTickSize)}},this)};this.contextMenu=new Ext.menu.Menu({items:[{text:"Tile",handler:this.tile,scope:this},{text:"Cascade",handler:this.cascade,scope:this},{text:"Close All",handler:this.closeAllWindows,scope:this}]});l.on("contextmenu",function(n){n.stopEvent();this.contextMenu.showAt(n.getXY())},this);h();if(i){i.on("click",function(r,q){q=r.getTarget("dt",i);if(q){r.stopEvent();var o=q.id.replace("-shortcut","");var p=b.getModule(o);if(p){p.createWindow()}else{if(b.modules){for(var s=0;s<b.modules.length;s++){for(var n=0;n<b.modules[s].launcher.menu.items.length;n++){if(b.modules[s].launcher.menu.items[n].code==o){b.modules[s].createWindow(b.modules[s].launcher.menu.items[n]);return}}}}}}})}};/*
 * Ext JS Library 3.3.1
 * Copyright(c) 2006-2010 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.app.App=function(a){Ext.apply(this,a);this.addEvents({ready:true,beforeunload:true});Ext.onReady(this.initApp,this)};Ext.extend(Ext.app.App,Ext.util.Observable,{isReady:false,startMenu:null,modules:null,getStartConfig:function(){},initApp:function(){this.startConfig=this.startConfig||this.getStartConfig();this.desktop=new Ext.Desktop(this);this.launcher=this.desktop.taskbar.startMenu;this.modules=this.getModules();if(this.modules){this.initModules(this.modules)}this.init();Ext.EventManager.on(window,"beforeunload",this.onUnload,this);this.fireEvent("ready",this);this.isReady=true},getModules:Ext.emptyFn,init:Ext.emptyFn,initModules:function(c){for(var d=0,b=c.length;d<b;d++){var a=c[d];this.launcher.add(a.launcher);a.app=this}},getModule:function(c){var b=this.modules;for(var d=0,a=b.length;d<a;d++){if(b[d].id==c||b[d].appType==c){return b[d]}}return""},onReady:function(b,a){if(!this.isReady){this.on("ready",b,a)}else{b.call(a,this)}},getDesktop:function(){return this.desktop},onUnload:function(a){if(this.fireEvent("beforeunload",this)===false){a.stopEvent()}}});/*
 * Ext JS Library 3.3.1
 * Copyright(c) 2006-2010 Sencha Inc.
 * licensing@sencha.com
 * http://www.sencha.com/license
 */
Ext.app.Module=function(a){Ext.apply(this,a);Ext.app.Module.superclass.constructor.call(this);this.init()};Ext.extend(Ext.app.Module,Ext.util.Observable,{init:Ext.emptyFn});Ext.namespace("Ext.ux.alvand");Ext.ux.alvand.WizardItinaryManager=function(){var b={};var c={};var a={};return{register:function(d,e){b[d]=e},get:function(e){var d=b[e];if(d){return d}else{Ext.Msg.show({title:"Wizard Itinary Not Registered",msg:"A Wizard Itinary named, "+e+", has not been registered.",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})}},getTip:function(e,d){return a[e+"_"+d]},addTip:function(e,d,f){a[e+"_"+d]=f},removeTip:function(e,d,g){var f=a[e+"_"+d];if(f){f.destroy();delete a[e+"_"+d]}},start:function(d){Ext.ux.alvand.WizardItinaryManager.next(d,0)},next:function(e,h){if(c[e]){}else{if(Ext.ux.alvand.WizardItinaryManager.getTip(e,h)){Ext.ux.alvand.WizardItinaryManager.getTip(e,h).show()}else{var d=Ext.ux.alvand.WizardItinaryManager.get(e,h);var l={target:"ux-taskbar-start"};if(d&&d.length>h){var j=MyDesktop.environ.communicator.guid();if(d[h].attachConfig){if(d[h].attachConfig.shortcut){l.target=d[h].attachConfig.shortcut}else{if(d[h].attachConfig.desktopItem){var f=MyDesktop;if(d[h].attachConfig.subgroup){if(f.modules){for(var k=0;k<f.modules.length;k++){if(f.modules[k].launcher&&f.modules[k].launcher.menu&&f.modules[k].launcher.menu.items){for(var m=0;m<f.modules[k].launcher.menu.items.length;m++){if(f.modules[k].launcher.menu.items[m].code==d[h].attachConfig.subgroup){f.modules[k].createWindow(f.modules[k].launcher.menu.items[m],l);break}}}}}}else{MyDesktop[d[h].attachConfig.desktopItem].prototype.createWindow(l)}}}}var g={wizardName:e,wizardIndex:h,anchor:"left",target:l.target,items:[{xtype:"label",text:d[h].text},new Ext.Toolbar({items:[{wizardName:e,wizardIndex:h,windowId:l.windowId,text:"Cancel",handler:function(o,p){if(o.wizardName){var n=Ext.ux.alvand.WizardItinaryManager.get(o.wizardName);if(n){Ext.ux.alvand.WizardItinaryManager.removeTip(e,h)}}},scope:this},"->",{wizardName:e,wizardIndex:h,windowId:l.windowId,text:"Back",hidden:(h==0),handler:function(o,q){if(o.wizardName){var n=Ext.ux.alvand.WizardItinaryManager.get(o.wizardName);if(n){if(o.windowId){var p=MyDesktop.getDesktop().getWindow(o.windowId);if(p){p.close()}delete o.windowId}Ext.ux.alvand.WizardItinaryManager.removeTip(e,h);if(n.length>o.wizardIndex+1){Ext.ux.alvand.WizardItinaryManager.next(e,o.wizardIndex-1)}}}},scope:this},{wizardName:e,wizardIndex:h,windowId:l.windowId,text:(h==d.length-1?"Complete":(h==0?"Start":"Continue")),handler:function(o,q){if(o.wizardName){var n=Ext.ux.alvand.WizardItinaryManager.get(o.wizardName);if(n){if(o.windowId){var p=MyDesktop.getDesktop().getWindow(o.windowId);if(p){p.close()}delete o.windowId}Ext.ux.alvand.WizardItinaryManager.removeTip(e,h);if(n.length>o.wizardIndex+1){Ext.ux.alvand.WizardItinaryManager.next(e,o.wizardIndex+1)}}}},scope:this}]})],title:"Token Management Console Walk-through",autoHide:false,closable:true,draggable:true,listeners:{hide:function(o){if(o.wizardName&&o.wizardIndex){var n=Ext.ux.alvand.WizardItinaryManager.get(o.wizardName);if(n){Ext.ux.alvand.WizardItinaryManager.removeTip(o.wizardName,o.wizardIndex)}}}}};var i=new Ext.ToolTip(g);Ext.ux.alvand.WizardItinaryManager.addTip(e,h,i);i.show.defer((Ext.isIE?500:300),i)}}}},stop:function(e){var d=Ext.ux.alvand.WizardItinaryManager.get(e)}}}();Ext.ux.alvand.WizardItinaryManager.register("overview",[{text:"Welcome to the Safenet Tokenization Management Console.  This console provides comprehensive facilities to manage your DataSecure data encryption and control solution.  This wizard will walk you through the features of this console.  Before we begin, a note on the general appearance and operation of this console.  This is a browser application, even though it may appear like a "+(fisheye?"Mac":"Windows")+' OS desktop.  It operates in the major browsers, IE, Firefox, Safari, and Chrome.  We chose this user interface style for two reasons.  First, because it functions much like Windows OS, there is a broad familiarity with this general opererating style.  Secondly, this being a management console application, we are able to provide the user with "multi-tasking" capability by allowing the view of multiple windows simultaneously.  Lets now proceed with the walk-thru and setup.  When you are ready to begin, please click the Start button.',attachConfig:{shortcut:(fisheye?"fisheye-menu-0":"wizard-win-shortcut")}},{text:"Administration of your tokenization tables is easy with the Tokenization Management Console.  You can configure new tokenization tables and monitor performance statistics such as the number of tokens within each table, and the average query time associated with each table.  Also, you can efficiently create, redeem and delete batches of tokens.  Lets review each of these Token Management features now.  When you are ready to begin, please click the Continue button.",attachConfig:{shortcut:(fisheye?"fisheye-menu-0":"wizard-win-shortcut")}},{text:'In order to administer tokens, at least a single database login is required.  Your authentication credentials to this site form the first database login.  You can add additional database logins as needed.  Lets take a look at the database login screen.  When you are ready to proceed, please click the "Continue" button.',attachConfig:{shortcut:(fisheye?"fisheye-menu-2":"dblogins-shortcut")}},{text:'Notice that your authenticated user has been added to this list.  This allows you to manage tokenization tables that this user is authorized to manage.  You can add additional database logins by clicking the add button, providing a username and password and then clicking the authenticate button.  Success or failure of the authentication process is visually displayed by the Logged In icon (a green check indicates success and a warning sign indicates failure).  Hovering over the success or failure icon will provide further details of the authentication attempt.   When you are ready to proceed, please click the "Continue" button.',attachConfig:{desktopItem:"ConfigurationModule",subgroup:"dblogins"}},{text:'In order to administer tokens, at least a single DataSecure appliance login is required.  Lets take a look at the DataSecure login screen.  When you are ready to proceed, please click the "Continue" button.',attachConfig:{shortcut:(fisheye?"fisheye-menu-3":"dslogins-shortcut")}},{text:'These logins provide the necessary credentials to connect to the DataSecure appliance.  Go ahead and add in a username and password that has authorization to connect to the DataSecure appliance.  When you have completed adding a username and password, please click the "Continue" button.',attachConfig:{desktopItem:"ConfigurationModule",subgroup:"dslogins"}},{text:'The "Tokenized Tables" form shows all of the tables that have been configured for tokenization support.  You can open multiple copies of this form by clicking on the desktop shortcut, or accessing the screen under the Start button.  This way you can manage tokenized tables for different database users simultaneously.  When you are ready to proceed, please click the "Continue" button.',attachConfig:{shortcut:(fisheye?"fisheye-menu-4":"tokentables-shortcut")}},{text:'This form displays the tokenization tables that each of your database login users have authorization to administer.  You can choose from the list of database users at the top of the form and the list of tokenization tables that user is authorized to administer will populate.  Notice that this table contains performance metrics indicating average query time and rowcount, in addition to the specifics regarding each configured tokenization table.  You can add a new tokenization table by clicking the Add button, and you can refresh the contents of the table list by clicking the Refresh button.  When you are ready to proceed, please click the "Continue" button.',attachConfig:{desktopItem:"ConfigurationModule",subgroup:"tokentables"}},{text:'The create token feature lets you add new tokens for specific values in a designated tokenization table.  Lets review the create token screen.  When you are ready to proceed, please click the "Continue" button.',attachConfig:{shortcut:(fisheye?"fisheye-menu-5":"createtoken-shortcut")}},{text:'To create a token, choose a database user, which will give you a filtered list of tokenization tables that user has authorization to administer.  Choose a DataSecure user for appliance access, and a mask type.  You can then add a series of values to be tokenized.  After adding your list of values, click the create button.  You are presented with a results list showing the value and token pair, and the execution time to perform the tokenization.  Furthermore, you are shown a status indicating success or failure for this operation.  Hovering over that success or failure icon will yield a detailed message pertaining to the create token operation.  Before you close the results form, highlight one of the Token values for a successully created token.  Copy it into your clipboard (ctrl-V).  We will now attempt to redeem the value for that token.  When you are ready to proceed, please click the "Continue" button.',attachConfig:{desktopItem:"TokenManagementModule",subgroup:"createtoken"}},{text:'The redeem token feature lets you redeem values for specific tokens in a designated tokenization table.  Lets review the redeem token screen.  When you are ready to proceed, please click the "Continue" button.',attachConfig:{shortcut:(fisheye?"fisheye-menu-6":"redeemtoken-shortcut")}},{text:'To redeem a token, choose a database user, which will give you a filtered list of tokenization tables that user has authorization to administer.  Choose a DataSecure user for appliance access, and a mask type.  You can then add a series of tokens to be redeemed.  Paste in the token that we copied to the clipboard on the create token result form, then click the redeem button.  Add another token to the list, but this time add in a value that has not been tokenized.  We will be able to see the failure message upon attempt to redeem a token that does not exist.  After clicking the Redeem button, you are presented with a results list showing the value and token pair, and the execution time to perform the redemption.  Furthermore, you are shown a status indicating success or failure for this operation.  Hovering over that success or failure icon will yield a detailed message pertaining to the redeem token operation.  Before you close the results form, highlight one of the Token values for a successully redeemed token.  Copy it into your clipboard (ctrl-V).  We will finally attempt to delete the token.  When you are ready to proceed, please click the "Continue" button.',attachConfig:{desktopItem:"TokenManagementModule",subgroup:"redeemtoken"}},{text:'The delete token feature lets you delete tokens for specific token list or value list, in a designated tokenization table.  Lets review the delete token screen.  When you are ready to proceed, please click the "Continue" button.',attachConfig:{shortcut:(fisheye?"fisheye-menu-7":"deletetoken-shortcut")}},{text:'To delete a token, choose a database user, which will give you a filtered list of tokenization tables that user has authorization to administer.  Choose a DataSecure user for appliance access, and a mask type.  Now, choose the option of either indicating a token list or a value list, with which to delete tokens with.  You can then add a series of values or tokens to result in deletion of tokens.  After adding your list of values or tokens, click the Delete button.  You are presented with a results list showing the value and token pair, and the execution time to perform the deletion.  Furthermore, you are shown a status indicating success or failure for this operation.  Hovering over that success or failure icon will yield a detailed message pertaining to the delete token operation.  When you are ready to proceed, please click the "Continue" button.',attachConfig:{desktopItem:"TokenManagementModule",subgroup:"deletetoken"}},{text:'The Token Management console provides a facility to monitor logs within your DataSecure environment.  Lets take a look at the Log Viewer Screen.  When you are ready to proceed, please click the "Continue" button.',attachConfig:{shortcut:(fisheye?"fisheye-menu-1":"log-win-shortcut")}},{text:'The Log Viewer allows you to choose a log source, such as the Web Server, Database Server or DataSecure Server.  You can also configure the refresh interval.  This indicates how often the log viewer will poll the server for new log messages.  Furthermore, you can specify the maximum number of new log messages that will be returned to the log viewer screen per refresh.  This is done so to keep your browser responding quickly.  The shorter the response, the less network delay will occur.  Play with these settings depending on the capacity of your environment.  Lastly, you can choose to filter based on log message severity.  For instance, you may wish to only monitor for FATAL log messages.  Much like the Tokenized tables form, you can open multiple log viewers simultaneously.  When you are ready to proceed, please click the "Continue" button.',attachConfig:{desktopItem:"LogWindow"}},{text:'This console provides the facility to test the performance of your DataSecure environment.  This information may be useful in identifying problems with the efficient operation of your environment.  Lets run a performance test.  When you are ready to proceed, please click the "Continue" button.'},{text:'To run a Performance QuickTest, enter a database user that you have configured, along with a tokenization table, DataSecure appliance user, and mask type.  You can now click the Run Test button.  This test will take approximately 1 minute to run.  Once the test has completed you will be presented with a chart indicating the throughput and elapsed time results from a series of token management operations.  Hovering over the chart data will reveal detailed information regarding the data points.  For reference, the Performance QuickTest is accessable by clicking on the Start Button in the lower left corner of the desktop.  Choose the Performance Menu Group and it will reveal the QuickTest.  When you are ready to proceed, please click the "Continue" button.',attachConfig:{desktopItem:"PerformanceModule",subgroup:"perfquicktest"}},{text:'If you have further questions regarding particular features of this console, you can refer to the help library.  Lets take a look at the help library form.  When you are ready to proceed, please click the "Continue" button.'},{text:'The Help Library contains help pages for each feature within the Token Management Console.  For reference, the Help Library is accessable by clicking on the Start Button in the lower left corner of the desktop.  Choose the Help Library menu option.  When you are ready to proceed, please click the "Continue" button.',attachConfig:{desktopItem:"HelpWindow"}},{text:"This completes the review of all of the features of the Safenet Tokenization Management Console.  We appreciate you using the Safenet Tokenization Management Console and look forward to any feedback that you may have so that we can make it more and more useful to you."}]);Ext.namespace("Ext.ux.alvand");Ext.ux.alvand.HistoryDispatch=function(){var a={};var b=new Ext.data.Store({reader:new Ext.data.ArrayReader({},[{name:"history"},{name:"historyindex"}])});return{register:function(d,c){a[d]=c},getStore:function(){return b},handle:function(c,d){if(d&&d.length>=2){var e=d[0];if(a[e]){a[e].call(c,d.slice(1))}}}}}();Ext.ux.alvand.regh=Ext.ux.alvand.HistoryDispatch.register;Ext.ux.alvand.reghh=Ext.ux.alvand.HistoryDispatch.handle;Ext.namespace("Ext.ux.alvand");Ext.ux.alvand.UserTokenTableStores=function(){var b={};var f;var d="tokenizedtables";var a="getTokenTableList";var c="";var g=false;var h=[];var e=Ext.ux.alvand.UserTokenTableStores;return{setEnvironment:function(i){f=i;c=(f.staticContent?f.staticUrl+f.communicator.getStaticResultFile(d,f.validContent):f.rootUrl+"SafenetTokenManagement/getTokenTableList?response=application/json/badgerfish")},register:function(k,j,i){if(!b[k]||i){if(!b[k]){b[k]=Ext.ux.alvand.UserTokenTableStores.createStore()}else{if(i){}}Ext.ux.alvand.UserTokenTableStores.loadTokenTables(k,j);Ext.ux.alvand.UserTokenTableStores.loadTokenSamples()}},isSampleLoaded:function(){return Ext.ux.alvand.UserTokenTableStores.sampleDataLoaded},getSampleValues:function(){return Ext.ux.alvand.UserTokenTableStores.sampleValues},getStore:function(i){return b[i]},createStore:function(){return new Ext.data.JsonStore({url:c,root:"data",idProperty:"tableName",fields:[{name:"tableName"},{name:"hmacKey"},{name:"encryptionKey"},{name:"dbUser"},{name:"queryDurationMillis",type:"int"},{name:"recordCount",type:"int"},{name:"sequential",type:"boolean"},{name:"datalength",type:"int"},{name:"record_deleted",type:"boolean"},{name:"record_new",type:"boolean"}]})},loadTokenTables:function(k,j){var i={dbUser:k,dbPassword:j};Ext.Ajax.request({url:c,success:Ext.ux.alvand.UserTokenTableStores.dataLoadSuccess,failure:f.communicator.dataLoadFailure,params:i,method:"POST"})},loadTokenSamples:function(){if(!Ext.ux.alvand.UserTokenTableStores.isSampleLoaded()){Ext.Ajax.request({url:f.staticUrl+"quicktestinputdata_valid.txt",success:Ext.ux.alvand.UserTokenTableStores.sampleDataLoadSuccess,failure:f.communicator.dataLoadFailure,method:"POST"})}},processResultObject:function(m,l,p){if(l["ax23:status"]&&l["ax23:status"]["ax23:statusCode"]&&l["ax23:status"]["ax23:statusCode"]["$"]){var o=l["ax23:status"]["ax23:statusCode"]["$"];if(o=="SUCCESS"){var q=l["ax23:tableKeyArray"];if(q){for(var n=0;n<q.length;n++){var k={dbUser:p.params.dbUser};if(q[n]["ax23:tableName"]&&q[n]["ax23:tableName"]["$"]){k.tableName=q[n]["ax23:tableName"]["$"]}if(q[n]["ax23:hmacKey"]&&q[n]["ax23:hmacKey"]["$"]){k.hmacKey=q[n]["ax23:hmacKey"]["$"]}if(q[n]["ax23:encryptionKey"]&&q[n]["ax23:encryptionKey"]["$"]){k.encryptionKey=q[n]["ax23:encryptionKey"]["$"]}if(q[n]["ax23:queryDurationMillis"]&&q[n]["ax23:queryDurationMillis"]["$"]){k.queryDurationMillis=q[n]["ax23:queryDurationMillis"]["$"]}if(q[n]["ax23:recordCount"]&&q[n]["ax23:recordCount"]["$"]){k.recordCount=q[n]["ax23:recordCount"]["$"]}m.push(k)}}}else{var j="An error occurred on the server, but no message was provided.  Please consult a technical representative.";if(l["ax23:status"]&&l["ax23:status"]["ax23:statusDescription"]&&l["ax23:status"]["ax23:statusDescription"]["$"]){var j=l["ax23:status"]["ax23:statusDescription"]["$"]}Ext.Msg.show({title:"An Error has occurred.",msg:j,buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})}}else{Ext.Msg.show({title:"No Status in response",msg:"There is no status object in the return structure.",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})}return m},dataLoadSuccess:function(k,p){try{if(k&&k.responseText){var n=Ext.decode(k.responseText);if(f.communicator.responseCheck2(n,p,a+"Response")){var m=new Array();var l=n["ns:"+a+"Response"]["ns:return"];if(l){if(Ext.isArray(l)){for(var o=0;o<l.length;o++){Ext.ux.alvand.UserTokenTableStores.processResultObject(m,l[o],p)}}else{Ext.ux.alvand.UserTokenTableStores.processResultObject(m,l,p)}}Ext.ux.alvand.UserTokenTableStores.getStore(p.params.dbUser).loadData({data:m})}}else{Ext.Msg.show({title:"Server Error",msg:"An error occurred attempting to ajax load data from the server.  No result was obtained",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})}}catch(j){Ext.Msg.show({title:"Critical Error",msg:j,buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}},sampleDataLoadSuccess:function(j,k){try{if(j&&j.responseText){Ext.ux.alvand.UserTokenTableStores.sampleValues=Ext.decode(j.responseText);
Ext.ux.alvand.UserTokenTableStores.sampleDataLoaded=true}else{Ext.Msg.show({title:"Server Error",msg:"An error occurred attempting to ajax load data from the server.  No result was obtained",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})}}catch(i){Ext.Msg.show({title:"Critical Error",msg:i,buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}},requestTokens:function(v,l,s,x,p,r,o,y,m,k){var j=Ext.decode(v);var n=(l?l:{});var t=new alvStringBuffer();for(var w in j){if(w!="values"){n[w]=j[w]}else{if(Ext.isArray(j[w])){var u=new Array();for(var q=0;q<j[w].length;q++){u.push(j[w][q].value)}if(n[r]==undefined){for(var q=0;q<u.length;q++){t.append("&");t.append(r);t.append("=");t.append(u[q])}}}}}Ext.Ajax.request({url:f.rootUrl+(x?p:o+"/"+s)+"?response=application/json/badgerfish"+t.toString(),method:"POST",success:(m?m:Ext.ux.alvand.UserTokenTableStores.trxResultLoadSuccess),failure:(k?k:f.communicator.dataLoadFailure),params:n,scope:y})},processTrxResultObject:function(m,l){if(l["ax21:status"]&&l["ax21:status"]["ax21:statusCode"]&&l["ax21:status"]["ax21:statusCode"]["$"]){var o=l["ax21:status"]["ax21:statusCode"]["$"];var i;if(l["ax21:status"]&&l["ax21:status"]["ax21:statusDescription"]&&l["ax21:status"]["ax21:statusDescription"]["$"]){var i=l["ax21:status"]["ax21:statusDescription"]["$"]}var j="";if(l["ax21:sensitiveValue"]&&l["ax21:sensitiveValue"]["$"]){j=l["ax21:sensitiveValue"]["$"]}var k="";if(l["ax21:tokenValue"]&&l["ax21:tokenValue"]["$"]){k=l["ax21:tokenValue"]["$"]}var n=0;if(l["ax21:executionTimeMillis"]&&l["ax21:executionTimeMillis"]["$"]){n=l["ax21:executionTimeMillis"]["$"]}m.push({value:j,token:k,statusCode:o,statusDescription:i,executionTimeMillis:n})}else{Ext.Msg.show({title:"No Status in response",msg:"There is no status object in the return structure.",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})}return m},trxResultLoadSuccess:function(i,j){}}}();Ext.namespace("Ext.ux.alvand");Ext.ux.alvand.Communicator=function(){return{responseCheck:function(b,c){try{if(b){if(b.success){return true}else{Ext.Msg.show({title:"Server Error",msg:(b.msg?b.msg:"A server error occurred attempting to retrieve data but no specific message was reported."),buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}}else{Ext.Msg.show({title:"Critical Error",msg:"An error occurred attempting to decode the json data from the server.",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}}catch(a){Ext.Msg.show({title:"Critical Error",msg:a,buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}},responseCheck2:function(c,e,b){try{var d="ns:";if(c){if(c[d+b]&&c[d+b][d+"return"]){return true}else{Ext.Msg.show({title:"Server Error",msg:(c.msg?c.msg:"A server error occurred attempting to retrieve data but no specific message was reported."),buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}}else{Ext.Msg.show({title:"Critical Error",msg:"An error occurred attempting to decode the json data from the server.",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}}catch(a){Ext.Msg.show({title:"Critical Error",msg:a,buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}},getResponseObject:function(b){try{if(b&&b.responseText){var c=Ext.decode(b.responseText);return c}else{Ext.Msg.show({title:"Server Error",msg:"An error occurred attempting to ajax load data from the server.  No result was obtained",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})}}catch(a){Ext.Msg.show({title:"Critical Error",msg:a,buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}},dataLoadFailure:function(a,b){Ext.Msg.show({title:"Server Ajax Error",msg:"An error occurred attempting to ajax load data from the server.",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})},S4:function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)},guid:function(){return("a"+this.S4()+this.S4()+this.S4()+this.S4()+this.S4()+this.S4()+this.S4()+this.S4())},bundleRequest:function(b,e,d,a,f,c){Ext.Ajax.request({url:b,params:{meta:Ext.encode(e),payload:Ext.encode(d)},success:a,failure:f,scope:c})},getStaticResultFile:function(a,b){return a+(b?"_valid.txt":"_invalid.txt")}}}();Ext.namespace("Ext.ux.alvand");function alvStringBuffer(){this.buffer=[]}alvStringBuffer.prototype.append=function append(a){this.buffer.push(a);return this};alvStringBuffer.prototype.toString=function toString(){return this.buffer.join("")};Ext.ux.alvand.sbuff=new alvStringBuffer();Ext.namespace("Ext.ux.alvand");Ext.ux.alvand.IFrameComponent=Ext.extend(Ext.BoxComponent,{onRender:function(b,a){this.el=b.createChild({tag:"iframe",id:"iframe-"+this.id,frameBorder:0,src:this.url})}});Ext.reg("alviframe",Ext.ux.alvand.IFrameComponent);Ext.namespace("Ext.ux.alvand.tree");Ext.ux.alvand.HelpPanel=Ext.extend(Ext.Panel,{layout:"border",region:"east",split:true,width:400,collapsible:true,collapsed:true,margins:"3 0 3 3",cmargins:"3 3 3 3",initComponent:function(){var a=new Ext.Panel({region:"center",layout:"card",layoutConfig:{layoutOnCardChange:true,deferredRender:true},activeItem:0,title:"Topic Details",id:this.id+"_helpDetailsPanel",collapsible:false,split:true,margins:"0 2 2 2",cmargins:"2 2 2 2",items:[{xtype:"alviframe",url:"/splash/tm/index.html"}]});this.items=[];this.items.push({xtype:"treepanel",title:"Topics",height:200,collapsible:true,helpDetailsPanelId:a.id,id:this.id+"_helpTreePanel",region:"north",margins:"2 2 0 2",autoScroll:true,rootVisible:false,root:new Ext.tree.AsyncTreeNode(),loader:new Ext.tree.TreeLoader({helpDetailsPanelId:a.id,dataUrl:this.environ.staticUrl+"help_topics.txt",createNode:function(b){var c=Ext.getCmp(this.helpDetailsPanelId);if(c){c.add({id:this.helpDetailsPanelId+"_"+b.id,xtype:"alviframe",url:b.url})}return Ext.tree.TreeLoader.prototype.createNode.call(this,b)},listeners:{load:function(c,f,e){var b=f.ownerTree;if(b){var d=b.getSelectionModel();if(d&&b.root&&b.root.childNodes&&b.root.childNodes.length>0){if(!d.getSelectedNode()){d.select(b.root.childNodes[0])}}}},loadexception:function(b,d,c){}}}),listeners:{render:function(b){b.getSelectionModel().on("selectionchange",function(c,e){var d=Ext.getCmp(e.ownerTree.helpDetailsPanelId);if(d){d.getLayout().setActiveItem(e.ownerTree.helpDetailsPanelId+"_"+e.id)}})}}});this.items.push(a);Ext.ux.alvand.HelpPanel.superclass.initComponent.call(this)}});Ext.reg("alvhelp",Ext.ux.alvand.HelpPanel);Ext.namespace("Ext.ux.alvand.form");Ext.ux.alvand.form.BaseToken=Ext.extend(Ext.form.FormPanel,{serviceProvider:"SafenetTokenService",allowClearForm:true,itemDefinitionArray:[],style:"padding: 5px;",frame:true,border:true,bodyStyle:"padding:5px 5px 0;",autoScroll:true,anchor:"-20",listeners:{render:function(a){var b=Ext.getCmp(a.id+"_dbUser");if(b){b.focus(true,1500)}}},getStaticResponseFile:function(){return this.staticResponseFile},getRequestType:function(){return this.requestType},clearTheForm:function(){this.getForm().reset();var a=this.getTokenGrid();if(a){a.getStore().removeAll();a.getView().refresh()}},initComponent:function(){if(this.allowClearForm){this.tbar=[{text:"Clear",iconCls:"alv-start",handler:function(){var a=this.ownerCt.ownerCt;if(a){a.clearTheForm()}}}]}this.initFieldDefinitions();this.items=[];this.items.push({title:this.title,labelWidth:120,border:false,defaults:{width:230},defaultType:"textfield",xtype:"fieldset",items:this.getItemDefinitionArray()});Ext.ux.alvand.form.BaseToken.superclass.initComponent.call(this)},getItemDefinitionArray:function(){return[]},getDBLoginValue:function(a){if(this.initialConfig.dbUserStore&&this.initialConfig.dbUserStore.data&&this.initialConfig.dbUserStore.data.items){for(var b=0;b<this.initialConfig.dbUserStore.data.items.length;b++){if(this.initialConfig.dbUserStore.data.items[b].data&&this.initialConfig.dbUserStore.data.items[b].data.username==a){return this.initialConfig.dbUserStore.data.items[b].data.password}}}return null},getHSMLoginValue:function(a){if(this.initialConfig.naeUserstore&&this.initialConfig.naeUserstore.data&&this.initialConfig.naeUserstore.data.items){for(var b=0;b<this.initialConfig.naeUserstore.data.items.length;b++){if(this.initialConfig.naeUserstore.data.items[b].data&&this.initialConfig.naeUserstore.data.items[b].data.username==a){return this.initialConfig.naeUserstore.data.items[b].data.password}}}return null},getTokenGrid:function(){return Ext.getCmp(this.id+"_tokengrid")},getCollectionParamName:function(){return"params"},getMaskField:function(){return Ext.getCmp(this.id+"_maskTypeField")},initFieldDefinitions:function(){this.dbUserField={fieldLabel:"DB User",id:this.id+"_dbUser",name:"dbUser",tabIndex:1,xtype:"alvlogincombo",environ:this.environ,navigatorId:this.navigatorId,loginType:"DB",store:this.dbUserStore,allowBlank:false,listeners:{select:{fn:function(d,c){var b=Ext.getCmp(d.ownerCt.ownerCt.id+"_tableName");if(b){var a=Ext.ux.alvand.UserTokenTableStores.getStore(d.getValue());if(a){b.store=a}}}},change:{fn:function(e,d,c){var b=Ext.getCmp(e.ownerCt.ownerCt.id+"_tableName");if(b){var a=Ext.ux.alvand.UserTokenTableStores.getStore(d);if(a){b.store=a}}}}}};this.tableNameField={fieldLabel:"Table Name",id:this.id+"_tableName",name:"tableName",tabIndex:2,xtype:"alvtokentablecombo",environ:this.environ,store:this.tokentablestore,navigatorId:this.navigatorId,allowBlank:false};this.naeUserField={fieldLabel:"DataSecure User",name:"naeUser",requireAuthentication:false,tabIndex:3,xtype:"alvlogincombo",environ:this.environ,navigatorId:this.navigatorId,loginType:"HSM",store:this.naeUserstore,allowBlank:false};this.maskTypeField={id:this.id+"_maskTypeField",fieldLabel:"Mask Type",name:"masktype",tabIndex:4,xtype:"alvtokenmask",environ:this.environ,allowBlank:false};this.tokenGrid={xtype:"panel",style:"padding: 30px;",width:400,items:{id:this.id+"_tokengrid",xtype:"alvgridcreatetoken",environ:this.environ,addText:'<span class="underline-shortcut">A</span>dd'},buttons:[{text:this.actionButtonText,handler:function(e,c){var h=this.getForm();if(h){var g=h.getValues();var b=this.getTokenGrid();if(b){var j=b.store.getModifiedRecords();var d=new Array();for(var f=0;f<j.length;f++){if(!j[f].data.record_deleted){d.push(j[f].getChanges())}}}if(g.dbUser){g.dbPassword=this.getDBLoginValue(g.dbUser)}if(g.naeUser){g.naePassword=this.getHSMLoginValue(g.naeUser)}g.values=d;var a=Ext.encode(g);if(!this.reswin){this.reswin=new Ext.ux.alvand.TokenResultWindow({environ:this.environ,gridResultsTitle:this.resultsGridTitle})
}this.reswin.setPayload(a,this.defaultActionParam,this.getRequestType(),this.environ.staticContent,this.environ.communicator.getStaticResultFile(this.getStaticResponseFile(),this.environ.validContent),this.getCollectionParamName(),this.serviceProvider);this.reswin.show(this)}},scope:this}]}}});Ext.reg("alvformbasetoken",Ext.ux.alvand.form.BaseToken);Ext.namespace("Ext.ux.alvand.form");Ext.ux.alvand.form.LoginComboBox=Ext.extend(Ext.form.ComboBox,{requireAuthentication:true,displayField:"username",typeAhead:true,mode:"local",triggerAction:"all",emptyText:"Select a login...",selectOnFocus:true,forceSelection:true,listeners:{afterrender:function(a){if(a.store&&a.store.getCount()==1){var b=a.store.getAt(0);if(b){a.fireEvent.defer(100,this,["change",a,b.get(a.store.reader.meta.idProperty),""]);a.setValue(b.get(a.store.reader.meta.idProperty))}}},beforeselect:function(c,a,b){if(c.requireAuthentication){if(a.get("loggedin")!=1){Ext.Msg.show({title:"Selected User is not authenticated.",msg:"The user you selected is not authenticated.  Please do so on the Database Logins Form.",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}}}},initComponent:function(){Ext.ux.alvand.form.LoginComboBox.superclass.initComponent.call(this)},onTriggerClick:function(a){if(this.store.getCount()==0){Ext.Msg.show({title:this.loginType+" Login Registration Needed",msg:"There are no "+this.loginType+" logins registered for this token management activity. Would you like to register a login?",buttons:Ext.Msg.YESNO,fn:function(b){if(b=="yes"){var c=(MyDesktop?MyDesktop:Ext.getCmp(this.navigatorId));if(c){c.displayLoginForm(this.loginType,true)}}},scope:this,animEl:"elId",icon:Ext.MessageBox.QUESTION})}else{Ext.ux.alvand.form.LoginComboBox.superclass.onTriggerClick.call(this,a)}}});Ext.reg("alvlogincombo",Ext.ux.alvand.form.LoginComboBox);Ext.namespace("Ext.ux.alvand.form");Ext.ux.alvand.form.TokenMask=Ext.extend(Ext.form.ComboBox,{redeem:false,displayField:"masktext",valueField:"format",hiddenName:"format",typeAhead:true,mode:"local",triggerAction:"all",emptyText:"Select a mask...",selectOnFocus:true,initComponent:function(){var a=this.redeem?[["0","None"],["6","Mask"]]:[["1","Random"],["2","Sequential"],["3","Last Four"],["4","First Six"],["5","First Two Last Four"],["7","First Six Last Four"],["8","Fixed Nineteen"]];this.store=new Ext.data.SimpleStore({fields:["format","masktext"],data:a});Ext.ux.alvand.form.TokenMask.superclass.initComponent.call(this)}});Ext.reg("alvtokenmask",Ext.ux.alvand.form.TokenMask);Ext.namespace("Ext.ux.alvand.form");Ext.ux.alvand.form.TokenTableComboBox=Ext.extend(Ext.form.ComboBox,{displayField:"tableName",valueField:"tableName",typeAhead:true,mode:"local",triggerAction:"all",emptyText:"Select a table...",selectOnFocus:true,initComponent:function(){Ext.ux.alvand.form.TokenTableComboBox.superclass.initComponent.call(this)},onTriggerClick:function(a){if(!this.store.data||this.store.getCount()==0){Ext.Msg.show({title:"Table Registration Needed",msg:"There are no tokenized tables registered. Would you like to register a tokenizable table?",buttons:Ext.Msg.YESNO,fn:function(b){if(b=="yes"){var c=(MyDesktop?MyDesktop:Ext.getCmp(this.navigatorId));if(c){c.displayTokenTableForm()}}},scope:this,animEl:"elId",icon:Ext.MessageBox.QUESTION})}else{Ext.ux.alvand.form.TokenTableComboBox.superclass.onTriggerClick.call(this,a)}}});Ext.reg("alvtokentablecombo",Ext.ux.alvand.form.TokenTableComboBox);Ext.ns("Ext.ux.alvand.grid");Ext.ux.alvand.grid.DeletableRowSelectionModel=Ext.extend(Ext.grid.RowSelectionModel,{width:30,sortable:false,dataIndex:0,menuDisabled:true,fixed:true,id:"deleter",initEvents:function(){Ext.ux.alvand.grid.DeletableRowSelectionModel.superclass.initEvents.call(this);this.grid.on("cellclick",function(b,f,c,d){if(c==b.getColumnModel().getIndexById("deleter")){var a=b.getStore().getAt(f);if(a){a.set("record_deleted",true);b.getStore().remove(a);b.getView().refresh()}}})},renderer:function(b,c,a,d){return'<div class="row-remove" style="width: 15px; height: 16px;"></div>'}});Ext.namespace("Ext.ux.alvand.grid");Ext.ux.alvand.grid.DBLogin=Ext.extend(Ext.grid.EditorGridPanel,{requireAuthentication:true,addText:'<span class="underline-shortcut">A</span>dd',autoExpandColumn:"username",height:250,clicksToEdit:1,frame:true,addItem:function(){},deleteItem:function(){},authenticateItem:function(){},getContainerTab:function(){return this.ownerCt.ownerCt},getContainerTabPanel:function(){return this.ownerCt.ownerCt.ownerCt},authenticateUser:function(a){var d=a.get("username");var b=a.get("password");var c="/ext/alvand/data/login_valid.txt";Ext.Ajax.request({url:c,success:function(e,g){var j=false;var h=Ext.util.JSON.decode(e.responseText);for(var f=0;f<h.users.length;f++){if(d==h.users[f].name){j=true;break}}if(j){a.set("loggedin",1);Ext.ux.alvand.UserTokenTableStores.register(a.get("username"),a.get("password"))}else{a.set("loggedin",0)}a.commit()},failure:function(e,f){a.set("loggedin",0);a.commit()},method:"POST",scope:this})},initComponent:function(){this.tbar=[{text:this.addText,iconCls:"x-icon-add",listeners:{render:function(a){globalKeyMap.accessKey({key:"a",alt:true},this.addItem,this);globalKeyMap.accessKey({key:"\t"},this.addItem,this)},scope:this},handler:function(){var a=this.ownerCt.ownerCt;var c=Ext.data.Record.create([{name:"username"},{name:"password"},{name:"loggedin"}]);var b=new c({username:"",password:"",loggedin:0});a.stopEditing();a.store.add(b);a.getView().refresh();a.getSelectionModel().selectRow(a.store.getCount()-1);a.startEditing(a.store.getCount()-1,1)}},{text:'<span class="underline-shortcut">D</span>elete',iconCls:"x-icon-delete",hidden:true,listeners:{render:function(a){globalKeyMap.accessKey({key:"d",alt:true},this.deleteItem,this)},scope:this},handler:function(){var b=this.ownerCt.ownerCt;var a=b.selModel.getSelected();if(a){b.stopEditing();b.getStore().remove(a);b.getView().refresh();if(b.store.getCount()>0){b.getSelectionModel().selectRow(b.store.getCount()-1)}}}},{text:'A<span class="underline-shortcut">u</span>thenticate',iconCls:"x-icon-authenticate",hidden:!this.requireAuthentication,listeners:{render:function(a){globalKeyMap.accessKey({key:"u",alt:true},this.authenticateItem,this)},scope:this},handler:function(){var a=this.selModel.getSelected();if(a){a.set("loggedin",-1);a.commit();this.authenticateUser.defer(1500,this,[a])}},scope:this}];this.selModel=new Ext.ux.alvand.grid.DeletableRowSelectionModel();this.columns=[this.selModel,{id:"username",header:"Username",width:160,sortable:true,dataIndex:"username",editor:{xtype:"textfield",allowBlank:false}},{id:"password",header:"Password",width:160,sortable:true,dataIndex:"password",renderer:function(){if(this.renderer&&this.renderer.arguments&&this.renderer.arguments.length&&this.renderer.arguments.length>0&&this.renderer.arguments[0]==""){return""}else{return"*****"}},editor:{xtype:"textfield",inputType:"password",allowBlank:false}},{header:"Logged In",xtype:"actioncolumn",dataIndex:"loggedin",hidden:!this.requireAuthentication,width:50,items:[{getClass:function(c,d,e){var a=e.get("loggedin");var b="x-icon-alv-failure";if(a==1){this.items[0].tooltip="This user has successfully authenticated";b="x-icon-alv-success"}else{if(a==0){this.items[0].tooltip="This user has not authenticated";b="x-icon-alv-failure"}else{this.items[0].tooltip="Authentication in progress...";b="x-icon-alv-processing"}}return b}}]}];Ext.ux.alvand.grid.DBLogin.superclass.initComponent.call(this)}});Ext.reg("alvgriddblogin",Ext.ux.alvand.grid.DBLogin);Ext.namespace("Ext.ux.alvand.form");Ext.ux.alvand.form.CreateTokenTable=Ext.extend(Ext.ux.alvand.form.BaseToken,{serviceProvider:"SafenetTokenManagement",allowClearForm:false,iconCls:"x-icon-tickets",staticResponseFile:"savetokenizedtables",getItemDefinitionArray:function(){return[this.dbUserField,this.tableNameTextField,this.naeUserField,this.hmacKeyNameField,this.encryptionKeyNameField,this.isSequentialField,this.dataLengthField]},initFieldDefinitions:function(){this.tableNameTextField={fieldLabel:"Table Name",id:this.id+"_tableName",name:"tableName",tabIndex:2,environ:this.environ,allowBlank:false};this.hmacKeyNameField={fieldLabel:"HMAC Key",name:"hmacKeyName",tabIndex:4,allowBlank:false};this.encryptionKeyNameField={fieldLabel:"Encryption Key",name:"encryptionKeyName",tabIndex:5,allowBlank:false};this.isSequentialField={fieldLabel:"Sequential?",name:"isSequential",tabIndex:6,xtype:"checkbox",listeners:{check:function(d,b){var a=this.ownerCt.ownerCt;var c=a.getForm().findField(a.id+"_dataLengthFld");if(c){if(b){c.show()}else{c.hide()}}}}};this.dataLengthField={id:this.id+"_dataLengthFld",tabIndex:7,fieldLabel:"Data Length",name:"dataLength",hidden:true,xtype:"numberfield",decimalPrecision:0,allowDecimals:false,allowNegative:false,minValue:1,maxValue:32};Ext.ux.alvand.form.CreateTokenTable.superclass.initFieldDefinitions.call(this)},buttons:[{text:"Save",handler:function(){var a=this.ownerCt.ownerCt;if(a){var b=a.getForm();var c=b.getValues();if(c.dbUser){c.dbPassword=a.getDBLoginValue(c.dbUser)}if(c.naeUser){c.naePassword=a.getHSMLoginValue(c.naeUser)}if(c.isSequential){c.isSequential=(c.isSequential=="on"?true:false)}else{c.isSequential=false}if(!c.dataLength||isNaN(c.dataLength)){c.dataLength=0}Ext.Ajax.request({url:(a.environ.staticContent?a.environ.staticUrl+a.environ.communicator.getStaticResultFile(a.staticResponseFile,a.environ.validContent):a.environ.rootUrl+a.serviceProvider+"/createTokenVaultTable?response=application/json/badgerfish"),success:a.addTableSuccess,failure:a.environ.communicator.dataLoadFailure,params:c,method:"GET",scope:a})}}},{text:"Cancel",handler:function(){var a=this.ownerCt.ownerCt;a.getForm().reset();a.ownerCt.hide()}}],processResultObject:function(d,c,f){if(c["ax23:status"]&&c["ax23:status"]["ax23:statusCode"]&&c["ax23:status"]["ax23:statusCode"]["$"]){var e=c["ax23:status"]["ax23:statusCode"]["$"];if(e=="SUCCESS"){var g=c["ax23:tableKeyArray"];if(g){var b={dbUser:f.params.dbUser};if(g["ax23:tableName"]&&g["ax23:tableName"]["$"]){b.tableName=g["ax23:tableName"]["$"]}if(g["ax23:hmacKey"]&&g["ax23:hmacKey"]["$"]){b.hmacKey=g["ax23:hmacKey"]["$"]}if(g["ax23:encryptionKey"]&&g["ax23:encryptionKey"]["$"]){b.encryptionKey=g["ax23:encryptionKey"]["$"]}if(g["ax23:queryDurationMillis"]&&g["ax23:queryDurationMillis"]["$"]){b.queryDurationMillis=g["ax23:queryDurationMillis"]["$"]}if(g["ax23:recordCount"]&&g["ax23:recordCount"]["$"]){b.recordCount=g["ax23:recordCount"]["$"]}d.push(b)}}else{var a="An error occurred on the server, but no message was provided.  Please consult a technical representative.";if(c["ax23:status"]&&c["ax23:status"]["ax23:statusDescription"]&&c["ax23:status"]["ax23:statusDescription"]["$"]){var a=c["ax23:status"]["ax23:statusDescription"]["$"]}Ext.Msg.show({title:"An Error has occurred.",msg:a,buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})}}else{Ext.Msg.show({title:"No Status in response",msg:"There is no status object in the return structure.",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})}return d},addTableSuccess:function(b,g){try{var h=true;var e=this.environ.communicator.getResponseObject(b);if(this.environ.communicator.responseCheck2(e,g,"createTokenVaultTableResponse")){var d=e["ns:createTokenVaultTableResponse"]["ns:return"];var c=new Array();this.processResultObject(c,d,g);if(c.length>0){var f=Ext.getCmp(this.gridId);if(f){f.addTokenTableRecord(c[0])}this.getForm().reset();this.ownerCt.hide()}}else{Ext.Msg.show({title:"Server Error",msg:"An error occurred attempting to ajax load data from the server.  No result was obtained",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})
}}catch(a){Ext.Msg.show({title:"Critical Error",msg:a,buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}}});Ext.reg("alvformcreatetokentable",Ext.ux.alvand.form.CreateTokenTable);Ext.namespace("Ext.ux.alvand.grid");Ext.ux.alvand.grid.TokenizedTables=Ext.extend(Ext.grid.GridPanel,{staticResponseFile:"savetokenizedtables",addText:'<span class="underline-shortcut">A</span>dd',height:250,frame:true,addTokenTableRecord:function(b){var c=Ext.data.Record.create([{name:"tableName"},{name:"hmacKey"},{name:"encryptionKey"},{name:"dbUser"},{name:"queryDurationMillis"},{name:"recordCount"},{name:"sequential"},{name:"datalength"},{name:"record_deleted"},{name:"record_new"}]);var a=new c({tableName:b.tableName,hmacKey:b.hmacKey,encryptionKey:b.encryptionKey,dbUser:b.dbUser,sequential:(b.isSequential=="on"?true:false),datalength:(b.dataLength?b.dataLength:0),queryDurationMillis:(b.queryDurationMillis?b.queryDurationMillis:0),recordCount:(b.recordCount?b.recordCount:0),record_new:true});this.store.add(a);this.getView().refresh();this.getSelectionModel().selectRow(this.store.getCount()-1)},initComponent:function(){var a=new Ext.grid.CheckColumn({hidden:true,header:"Sequential",dataIndex:"sequential",width:55});this.plugins=a;this.tbar=[{text:this.addText,iconCls:"x-icon-add",listeners:{render:function(b){globalKeyMap.accessKey({key:"a",alt:true},this.addItem,this);globalKeyMap.accessKey({key:"\t"},this.addItem,this)},scope:this},handler:function(){if(!this.addwin){this.addwin=new Ext.Window({title:"Add Tokenized Table",layout:"fit",width:440,height:320,plain:true,closeAction:"hide",modal:false,environ:this.environ,items:[{xtype:"alvformcreatetokentable",gridId:this.id,environ:this.environ,naeUserstore:this.naeUserstore,dbUserStore:this.dbUserStore,tokentablestore:this.store}]})}this.addwin.show(this)},scope:this},{text:'<span class="underline-shortcut">D</span>elete',iconCls:"x-icon-delete",hidden:true,listeners:{render:function(b){globalKeyMap.accessKey({key:"d",alt:true},this.deleteItem,this)},scope:this},handler:function(){var c=this.ownerCt.ownerCt;var b=c.selModel.getSelected();if(b){b.set("record_deleted",true);c.getStore().remove(b);if(c.store.getCount()>0){c.getSelectionModel().selectRow(c.store.getCount()-1)}}}},{text:"Refresh",iconCls:"alv-reset",handler:function(){var d=this.ownerCt.ownerCt;if(d){if(d.ownerCt&&d.ownerCt.items&&d.ownerCt.items.length>0){var e=d.ownerCt.items.items[0].getValue();if(e){var b=MyDesktop.dbUserStore;if(b&&b.data&&b.data.items){for(var c=0;c<b.data.items.length;c++){if(b.data.items[c].data&&b.data.items[c].data.username==e){var f=b.data.items[c].data.password;if(f){Ext.ux.alvand.UserTokenTableStores.register(e,f,true);d.getView().refresh();return true}}}}}}}}}];this.columns=[{id:"tableName",header:"Table Name",width:100,sortable:true,dataIndex:"tableName",editor:{xtype:"textfield",allowBlank:false,selectOnFocus:true}},{header:"HMAC Key",width:100,sortable:true,dataIndex:"hmacKey",editor:{xtype:"textfield",allowBlank:false,selectOnFocus:true}},{header:"Encryption Key",width:100,sortable:true,dataIndex:"encryptionKey",editor:{xtype:"textfield",allowBlank:false,selectOnFocus:true}},{header:"DB Login",width:120,sortable:true,dataIndex:"dbUser",editor:{xtype:"alvlogincombo",navigatorId:this.navigatorId,loginType:"DB",store:this.dbUserStore,allowBlank:false}},{header:"Query Time(ms)",width:100,sortable:true,dataIndex:"queryDurationMillis",editor:{xtype:"numberfield",selectOnFocus:true}},{header:"Rowcount",width:100,sortable:true,dataIndex:"recordCount",editor:{xtype:"numberfield",selectOnFocus:true}},a,{header:"Data Length",hidden:true,width:100,sortable:true,dataIndex:"datalength",editor:{xtype:"numberfield",selectOnFocus:true}},{xtype:"actioncolumn",dataIndex:"record_errors",width:50,items:[{getClass:function(c,e,f){var b=f.get("record_errors");if(b&&b.length&&b.length>0){var g=new alvStringBuffer();g.append("Validation Errors:<UL>");for(var d=0;d<b.length;d++){g.append("<LI>");g.append(b[d].message)}g.append("</UL>");this.items[0].tooltip=g.toString();return"x-icon-saveerror"}else{this.items[0].tooltip=undefined;return"x-icon-blank"}}}]},{hidden:true,dataIndex:"record_deleted",xtype:"booleancolumn"},{hidden:true,dataIndex:"record_new",xtype:"booleancolumn"}];
Ext.ux.alvand.grid.TokenizedTables.superclass.initComponent.call(this)}});Ext.reg("alvgridtokentables",Ext.ux.alvand.grid.TokenizedTables);Ext.namespace("Ext.ux.alvand.grid");Ext.ux.alvand.grid.CreateToken=Ext.extend(Ext.grid.EditorGridPanel,{addText:'<span class="underline-shortcut">A</span>dd',autoExpandColumn:"value",height:250,clicksToEdit:1,frame:true,addItem:function(){var a=this.getTopToolbar();var b=a.items.items[0];if(b){b.handler.call(b.scope||b,b)}},deleteItem:function(){var a=this.getTopToolbar();var b=a.items.items[1];if(b){b.handler.call(b.scope||b,b)}},initComponent:function(){this.tbar=[{text:this.addText,iconCls:"x-icon-add",listeners:{render:function(a){globalKeyMap.accessKey({key:"a",alt:true},this.addItem,this)},scope:this},handler:function(){var a=this.ownerCt.ownerCt;var c=Ext.data.Record.create([{name:"value"},{name:"record_deleted"}]);var b=new c({value:""});a.stopEditing();a.store.add(b);a.getView().refresh();a.getSelectionModel().selectRow(a.store.getCount()-1);a.startEditing(a.store.getCount()-1,1)}},{text:'<span class="underline-shortcut">D</span>elete',iconCls:"x-icon-delete",listeners:{render:function(a){globalKeyMap.accessKey({key:"d",alt:true},this.deleteItem,this)},scope:this},handler:function(){var b=this.ownerCt.ownerCt;var a=b.selModel.getSelected();if(a){a.set("record_deleted",true);b.stopEditing();b.getStore().remove(a);b.getView().refresh();if(b.store.getCount()>0){b.getSelectionModel().selectRow(b.store.getCount()-1)}}}}];this.selModel=new Ext.ux.alvand.grid.DeletableRowSelectionModel();this.columns=[this.selModel,{id:"value",header:"Value",width:160,sortable:true,dataIndex:"value",editor:{xtype:"textfield",allowBlank:false}},{hidden:true,xtype:"booleancolumn",dataIndex:"record_deleted"}];this.store=new Ext.data.Store({reader:new Ext.data.ArrayReader({},[{name:"value"},{name:"record_deleted"}])});Ext.ux.alvand.grid.CreateToken.superclass.initComponent.call(this)}});Ext.reg("alvgridcreatetoken",Ext.ux.alvand.grid.CreateToken);Ext.namespace("Ext.ux.alvand.grid");Ext.ux.alvand.grid.ResultToken=Ext.extend(Ext.grid.GridPanel,{viewConfig:{templates:{cell:new Ext.Template('<td class="x-grid3-col x-grid3-cell x-grid3-td-{id} x-selectable {css}" style="{style}" tabIndex="0" {cellAttr}>','<div class="x-grid3-cell-inner x-grid3-col-{id}" {attr}>{value}</div>',"</td>")}},environ:{},autoExpandColumn:"value",height:250,frame:true,addItem:function(){var a=this.getTopToolbar();var b=a.items.items[0];if(b){b.handler.call(b.scope||b,b)}},deleteItem:function(){var a=this.getTopToolbar();var b=a.items.items[1];if(b){b.handler.call(b.scope||b,b)}},initComponent:function(){this.columns=[{id:"value",header:"Value",width:160,sortable:true,dataIndex:"value"},{header:"Token",width:160,sortable:true,dataIndex:"token"},{header:"Exec Time(ms)",width:100,sortable:true,dataIndex:"executionTimeMillis",editor:{xtype:"numberfield",selectOnFocus:true}},{xtype:"actioncolumn",dataIndex:"statusCode",width:50,items:[{getClass:function(b,d,e){var c=e.get("statusCode");var a=e.get("statusDescription");if(a&&a.length>0){this.items[0].tooltip=a}if(c=="SUCCESS"){return"x-icon-alv-success"}else{return"x-icon-alv-failure"}}}]},{hidden:true,dataIndex:"statusDescription"}];this.store=new Ext.data.Store({reader:new Ext.data.JsonReader({root:"data",idProperty:"value",storeId:this.id+"_rStore"},[{name:"value"},{name:"token"},{name:"executionTimeMillis",type:"int"},{name:"statusCode"},{name:"statusDescription"}])});Ext.ux.alvand.grid.ResultToken.superclass.initComponent.call(this)},requestTokens:function(f,d,b,a,c,e,g){this.requestType=b;Ext.ux.alvand.UserTokenTableStores.requestTokens(f,d,b,a,c,e,g,this,this.dataLoadSuccess)},dataLoadSuccess:function(b,g){try{if(b&&b.responseText){var e=Ext.decode(b.responseText);if(this.environ.communicator.responseCheck2(e,g,this.requestType+"Response")){var d=new Array();var c=e["ns:"+this.requestType+"Response"]["ns:return"];if(c){if(Ext.isArray(c)){for(var f=0;f<c.length;f++){Ext.ux.alvand.UserTokenTableStores.processTrxResultObject(d,c[f])}}else{Ext.ux.alvand.UserTokenTableStores.processTrxResultObject(d,c)}}this.store.loadData({data:d})}}else{Ext.Msg.show({title:"Server Error",msg:"An error occurred attempting to ajax load data from the server.  No result was obtained",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})}}catch(a){Ext.Msg.show({title:"Critical Error",msg:a,buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}}});Ext.reg("alvgridresultstoken",Ext.ux.alvand.grid.ResultToken);Ext.namespace("Ext.ux.alvand");Ext.ux.alvand.TokenResultWindow=Ext.extend(Ext.Window,{gridResultsTitle:"",payload:"{}",title:"Results",layout:"fit",width:500,height:300,plain:true,closeAction:"hide",modal:false,listeners:{beforeshow:function(b){var a=Ext.getCmp(b.id+"_payload");if(a){a.setValue(b.payload)}}},initComponent:function(){this.items=[];this.items.push({border:false,items:[{title:this.gridResultsTitle,id:this.id+"_tokenresultsgrid",xtype:"alvgridresultstoken",environ:this.environ,layout:"fit"}]});this.buttons=[{text:"Close",handler:function(){this.hide()},scope:this}];Ext.ux.alvand.TokenResultWindow.superclass.initComponent.call(this)},setPayload:function(g,e,c,b,d,f,h){this.payload=g;this.requestType=c;var a=Ext.getCmp(this.id+"_tokenresultsgrid");if(a){a.requestTokens(g,e,c,b,d,f,h)}}});Ext.reg("alvwindowtokenresults",Ext.ux.alvand.TokenResultWindow);Ext.namespace("Ext.ux.alvand.grid");Ext.ux.alvand.grid.QuickTestSummaryGrid=Ext.extend(Ext.grid.GridPanel,{requireAuthentication:true,height:250,frame:true,resWins:{},deleteItem:function(){},updateTestStatus:function(e,f,d,c){var a=this.getStore().find("id",e);if(a>-1){var b=this.getStore().getAt(a);if(b){b.set(f,d);if(c){b.set(f+"Results",Ext.encode(c))}}}},showResultWindow:function(a,b,d){var e=a.get("id");if(!this.resWins[e+b]){this.resWins[e+b]=new Ext.ux.alvand.QuickTestResultWindow({environ:this.environ,title:d})}var c=a.get(b+"Results");this.resWins[e+b].setPayload(c);this.resWins[e+b].show()},initComponent:function(){this.store=new Ext.data.Store({reader:new Ext.data.ArrayReader({idProperty:"id"},[{name:"id"},{name:"testDate"},{name:"dbUser"},{name:"tableName"},{name:"naeUser"},{name:"masktype"},{name:"serverSideApiTest"},{name:"webServerTest"},{name:"serverSideApiTestResults"},{name:"webServerTestResults"}])});this.tbar=[{text:'<span class="underline-shortcut">D</span>elete',iconCls:"x-icon-delete",listeners:{render:function(a){globalKeyMap.accessKey({key:"d",alt:true},this.deleteItem,this)},scope:this},handler:function(){var b=this.ownerCt.ownerCt;var a=b.selModel.getSelected();if(a){b.stopEditing();b.getStore().remove(a);b.getView().refresh();if(b.store.getCount()>0){b.getSelectionModel().selectRow(b.store.getCount()-1)}}}}];this.selModel=new Ext.ux.alvand.grid.DeletableRowSelectionModel();this.columns=[this.selModel,{id:"id",dataIndex:"id",hidden:true},{header:"Test Date",width:140,sortable:true,xtype:"datecolumn",format:"Y-m-d H:i:sO",dataIndex:"testDate"},{header:"DB User",width:90,sortable:true,dataIndex:"dbUser"},{header:"Table Name",width:100,sortable:true,dataIndex:"tableName"},{header:"DataSecure User",width:90,sortable:true,dataIndex:"naeUser"},{header:"Mask Type",width:90,sortable:true,dataIndex:"masktype"},{dataIndex:"serverSideApiTestResults",hidden:true},{dataIndex:"webServerTestResults",hidden:true},{header:"Server Side Test",xtype:"actioncolumn",dataIndex:"serverSideApiTest",width:80,items:[{getClass:function(c,d,e){var b=e.get("serverSideApiTest");var a="x-icon-alv-failure";if(b==1){this.items[0].tooltip="The test is complete.  Click to view results.";a="x-icon-alv-success"}else{if(b==0){this.items[0].tooltip="A failure occurred in conducting the test.";a="x-icon-alv-failure"}else{if(b==-99){this.items[0].tooltip="Test has not started...";a="x-icon-blank"}else{this.items[0].tooltip="Test in progress...";a="x-icon-alv-processing"}}}return a},handler:function(b,d,a){var c=b.getStore().getAt(d);b.showResultWindow(c,this.dataIndex,"Server Side API Test- "+c.get("testDate").format("Y-m-d H:i:sO"))}}]},{header:"Web Server Test",xtype:"actioncolumn",dataIndex:"webServerTest",width:80,items:[{getClass:function(c,d,e){var b=e.get("webServerTest");var a="x-icon-alv-failure";if(b==1){this.items[0].tooltip="The test is complete.  Click to view results.";a="x-icon-alv-success"}else{if(b==0){this.items[0].tooltip="A failure occurred in conducting the test.";a="x-icon-alv-failure"}else{if(b==-99){this.items[0].tooltip="Test has not started...";a="x-icon-blank"}else{this.items[0].tooltip="Test in progress...";a="x-icon-alv-processing"}}}return a},handler:function(b,d,a){var c=b.getStore().getAt(d);b.showResultWindow(c,this.dataIndex,"Web Server Test - "+c.get("testDate").format("Y-m-d H:i:sO"))}}]}];Ext.ux.alvand.grid.QuickTestSummaryGrid.superclass.initComponent.call(this)}});Ext.reg("alvgridquicktestsummary",Ext.ux.alvand.grid.QuickTestSummaryGrid);Ext.namespace("Ext.ux.alvand.form");Ext.ux.alvand.form.QuickTestResultForm=Ext.extend(Ext.Panel,{getChart:function(){return Ext.getCmp(this.id+"_quicktestchart")},initComponent:function(){this.items=[];this.items.push({hidden:false,id:this.id+"_quicktestchart",xtype:"barchart",plugins:[new Ext.ux.plugin.VisibilityMode()],width:500,height:300,store:new Ext.data.JsonStore({fields:["testName","throughputTokensPerSecond","totalElapsedTimeMillis","testDescription"],data:[]}),yField:"testName",tipRenderer:function(d,a,b,c){return a.data.testName+"\nThroughput:  "+a.data.throughputTokensPerSecond+" tokens per second \nElapsed Time:  "+a.data.totalElapsedTimeMillis+" seconds \n"+a.data.testDescription},xAxis:new Ext.chart.NumericAxis({stackingEnabled:true}),series:[{xField:"throughputTokensPerSecond",displayName:"Throughput (tokens/second)"},{xField:"totalElapsedTimeMillis",displayName:"Elapsed Time (seconds)"}],chartStyle:{legend:{display:"bottom"}}});Ext.ux.alvand.form.QuickTestResultForm.superclass.initComponent.call(this)}});Ext.reg("alvformquicktestresult",Ext.ux.alvand.form.QuickTestResultForm);Ext.namespace("Ext.ux.alvand.form");Ext.ux.alvand.QuickTestResultWindow=Ext.extend(Ext.Window,{payload:"{}",title:"Results",layout:"fit",width:500,height:350,plain:true,closeAction:"hide",modal:false,initComponent:function(){this.items=[];this.items.push({border:false,items:[{title:this.gridResultsTitle,id:this.id+"_quicktestresultform",xtype:"alvformquicktestresult",environ:this.environ,layout:"fit"}]});this.buttons=[{text:"Close",handler:function(){this.hide()},scope:this}];Ext.ux.alvand.QuickTestResultWindow.superclass.initComponent.call(this)},setPayload:function(d){var b=Ext.decode(d);var a=Ext.getCmp(this.id+"_quicktestresultform");if(a){var c=a.getChart();if(c){c.store.loadData(b)}}}});Ext.reg("alvwindowquicktestresults",Ext.ux.alvand.QuickTestResultWindow);Ext.namespace("Ext.ux.alvand.form");Ext.ux.alvand.form.QuickTestForm=Ext.extend(Ext.ux.alvand.form.BaseToken,{jobBatchGroupResult:[],jobBatchGroupRequest:[],jobBatchGroupIndex:0,jobBatchResult:[],jobBatchRequest:[],jobBatchIndex:0,serviceProvider:"SafenetTokenTests",actionButtonText:"Run Test",defaultActionParam:{},requestType:"quickTest",staticResponseFile:"quicktestresults",iconCls:"x-icon-tickets",listeners:{render:function(a){if(!Ext.ux.alvand.UserTokenTableStores.isSampleLoaded()){Ext.Msg.show({title:"Performance Testing Not Ready to Execute",msg:"There seems to be a problem with the loading of sample data to conduct this performance test.  Try closing this form and reopening it.  If the problem persists, please contact your system administrator for futher assistance.",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.INFO})}}},getItemDefinitionArray:function(){return[this.dbUserField,this.tableNameField,this.naeUserField,this.maskTypeField,this.quickTestSummaryGrid]},clearTheForm:function(){Ext.ux.alvand.form.QuickTestForm.superclass.clearTheForm.call(this)},getLoadingPanel:function(){return Ext.getCmp(this.id+"_loadingPanel")},getSummaryGrid:function(){return Ext.getCmp(this.id+"_quicktestsummarygrid")},initFieldDefinitions:function(){this.quickTestSummaryGrid={id:this.id+"_quicktestsummarygrid",xtype:"alvgridquicktestsummary",environ:this.environ,anchor:"100%"};Ext.ux.alvand.form.QuickTestForm.superclass.initFieldDefinitions.call(this)},initComponent:function(){this.quickTestStore=new Ext.data.JsonStore({fields:["testName","throughputTokensPerSecond","totalElapsedTimeMillis","testDescription"],data:[]});this.buttons=[{id:this.id+"_runtestbtn",text:this.actionButtonText,handler:function(a,c){var d=this.getForm();if(d){var e=d.getValues();if(e.dbUser){e.dbPassword=this.getDBLoginValue(e.dbUser)}if(e.naeUser){e.naePassword=this.getHSMLoginValue(e.naeUser)}var b=Ext.encode(e);this.runServerSideTest()}},scope:this}];Ext.ux.alvand.form.QuickTestForm.superclass.initComponent.call(this)},setRunTestButtonState:function(a){if(this.buttons&&this.buttons.length>0){(a?this.buttons[0].disable():this.buttons[0].enable())}},runServerSideTest:function(){var b=this.getSummaryGrid();if(b){var h=this.getRequestType();var j=this.environ.staticContent;var f=this.environ.communicator.getStaticResultFile(this.getStaticResponseFile(),this.environ.validContent);var e=this.serviceProvider;var i=this.getForm();var g=i.getValues();var c=Ext.data.Record.create([{name:"id"},{name:"testDate"},{name:"dbUser"},{name:"tableName"},{name:"naeUser"},{name:"masktype"},{name:"serverSideApiTest"},{name:"webServerTest"}]);var d=new c({id:this.environ.communicator.guid(),testDate:new Date(),dbUser:g.dbUser,tableName:g.tableName,naeUser:g.naeUser,masktype:this.getMaskField().getRawValue(),serverSideApiTest:-1,webServerTest:-99});b.store.add(d);b.getView().refresh();b.getSelectionModel().selectRow(b.store.getCount()-1);g.id=d.data.id;g.testType="serverSideApiTest";if(g.dbUser){g.dbPassword=this.getDBLoginValue(g.dbUser)}if(g.naeUser){g.naePassword=this.getHSMLoginValue(g.naeUser)}if(g.format){g.maskType=g.format;delete g.format}if(g.tableName){g.tokenTable=g.tableName;delete g.tableName}var a=Ext.encode(g);this.setRunTestButtonState(true);Ext.Ajax.request({url:this.environ.rootUrl+(j?f:e+"/"+h)+"?response=application/json/badgerfish",method:"POST",success:this.dataLoadSuccess,failure:this.dataLoadFailure,params:g,scope:this})}},runWebServerTest:function(c){c.testType="webServerTest";this.jobBatchGroupParams=c;var g=[];var j=[];var a=Ext.ux.alvand.UserTokenTableStores.getSampleValues();if(a&&a.length==300){var d="SafenetTokenService";var b=new Array();var h=1;var e=a.slice(0,100);g=[];for(var f=0;f<e.length;f+=h){b=e.slice(f,f+h);g.push(this.buildJob(b,"insertBatch","valueArray",d,"createtokenresults",{luhnCheck:1}))}j.push(this.buildJobBatch("T Ind 100","Tokenized 100 values individually",g));g=[];for(var f=0;f<e.length;f+=h){b=e.slice(f,f+h);g.push(this.buildJob(b,"insertBatch","valueArray",d,"createtokenresults",{luhnCheck:1}))
}j.push(this.buildJobBatch("RT Ind 100","Re-Tokenized 100 values individually",g));g=[];for(var f=0;f<e.length;f+=h){b=e.slice(f,f+h);g.push(this.buildJob(b,"getBatch","tokenArray",d,"redeemtokenresults",{}))}j.push(this.buildJobBatch("G Ind 100","De-Tokenized 100 values individually",g));e=a.slice(100,200);h=10;g=[];for(var f=0;f<e.length;f+=h){b=e.slice(f,f+h);g.push(this.buildJob(b,"insertBatch","valueArray",d,"createtokenresults",{luhnCheck:1}))}j.push(this.buildJobBatch("T 10x10","Tokenized 100 values in 10 batches of 10",g));g=[];for(var f=0;f<e.length;f+=h){b=e.slice(f,f+h);g.push(this.buildJob(b,"insertBatch","valueArray",d,"createtokenresults",{luhnCheck:1}))}j.push(this.buildJobBatch("RT 10x10","Re-Tokenized 100 values in 10 batches of 10",g));g=[];for(var f=0;f<e.length;f+=h){b=e.slice(f,f+h);g.push(this.buildJob(b,"getBatch","tokenArray",d,"redeemtokenresults",{}))}j.push(this.buildJobBatch("G 10x10","De-Tokenized 100 values in 10 batches of 10",g));e=a.slice(200,300);h=100;g=[];for(var f=0;f<e.length;f+=h){b=e.slice(f,f+h);g.push(this.buildJob(b,"insertBatch","valueArray",d,"createtokenresults",{luhnCheck:1}))}j.push(this.buildJobBatch("T 1x100","Tokenized 100 values in one batch",g));g=[];for(var f=0;f<e.length;f+=h){b=e.slice(f,f+h);g.push(this.buildJob(b,"insertBatch","valueArray",d,"createtokenresults",{luhnCheck:1}))}j.push(this.buildJobBatch("RT 1x100","Re-Tokenized 100 values in one batch",g));g=[];for(var f=0;f<e.length;f+=h){b=e.slice(f,f+h);g.push(this.buildJob(b,"getBatch","tokenArray",d,"redeemtokenresults",{}))}j.push(this.buildJobBatch("G 1x100","De-Tokenized 100 values in one batch",g));g=[];for(var f=0;f<a.length;f+=h){b=a.slice(f,f+h);g.push(this.buildJob(b,"deleteValueBatch","valueArray",d,"deletevalueresults",{}))}j.push(this.buildJobBatch("D 1x100","Deleted 100 values in one batch",g))}this.startJobBatchGroup(j)},buildJobBatch:function(b,c,a){return{testName:b,testDescription:c,totalElapsedTimeMillis:0,throughputTokensPerSecond:0,batch:a}},buildJob:function(d,a,e,f,b,c){return{input:d,defaultParam:c,requestType:a,isStatic:this.environ.staticContent,staticResponseFile:this.environ.communicator.getStaticResultFile(b,this.environ.validContent),paramName:e,serviceProvider:f}},startJobBatchGroup:function(b){this.jobBatchGroupRequest=b;this.jobBatchGroupResult=[];this.jobBatchGroupIndex=0;if(this.jobBatchGroupRequest.length>0){var a=this.jobBatchGroupRequest[0];this.runJobBatch(a,0)}},runJobBatch:function(a,d){var b=new Date();this.jobBatchStartTime=b.getTime();this.jobBatchGroupIndex=d;this.jobBatchRequest=a;this.jobBatchResult=[];this.jobBatchIndex=0;if(this.jobBatchRequest.batch.length>0){var c=this.jobBatchRequest.batch[0];this.runJob(c,0)}},runJob:function(a,c){this.jobBatchIndex=c;if(!a.defaultParam){a.defaultParam={}}if(!a.defaultParam.requestType){a.defaultParam.requestType=a.requestType}if(!a.defaultParam.paramName){a.defaultParam.paramName=a.paramName}a.defaultParam.testType=this.jobBatchGroupParams.testType;a.defaultParam.id=this.jobBatchGroupParams.id;var b=this.preparePayload(a.input,a.paramName);Ext.ux.alvand.UserTokenTableStores.requestTokens(b,a.defaultParam,a.requestType,a.isStatic,a.staticResponseFile,a.paramName,a.serviceProvider,this,this.webTestDataLoadSuccess,this.dataLoadFailure)},normalizeStaticResponse:function(a,b){if(a>b.length){b.push(b[0]);this.normalizeStaticResponse(a,b)}else{if(a<b.length){b.pop();this.normalizeStaticResponse(a,b)}}return b},webTestDataLoadSuccess:function(n,e){try{if(n&&n.responseText){var k=Ext.decode(n.responseText);if(this.environ.communicator.responseCheck2(k,e,e.params.requestType+"Response")){var b=new Array();var f=k["ns:"+e.params.requestType+"Response"]["ns:return"];if(f){if(Ext.isArray(f)){for(var g=0;g<f.length;g++){Ext.ux.alvand.UserTokenTableStores.processTrxResultObject(b,f[g])}}else{Ext.ux.alvand.UserTokenTableStores.processTrxResultObject(b,f)}}if(this.environ.staticContent&&b.length>0&&e.url){var j=Ext.urlDecode(e.url);if(j[e.params.paramName]){var c=(Ext.isArray(j[e.params.paramName])?j[e.params.paramName].length:1);
b=this.normalizeStaticResponse(c,b)}}this.jobBatchResult=this.jobBatchResult.concat(b);if(this.jobBatchIndex+1<this.jobBatchRequest.batch.length){this.runJob(this.jobBatchRequest.batch[this.jobBatchIndex+1],this.jobBatchIndex+1)}else{var h=new Date();var d=h.getTime()-this.jobStartTime;var m={testName:this.jobBatchGroupRequest[this.jobBatchGroupIndex].testName,testDescription:this.jobBatchGroupRequest[this.jobBatchGroupIndex].testdescrption,totalElapsedTimeMillis:(h.getTime()-this.jobBatchStartTime)/1000,throughputTokensPerSecond:this.jobBatchResult.length/((h.getTime()-this.jobBatchStartTime)/1000)};if(this.jobBatchResult){}this.jobBatchGroupResult=this.jobBatchGroupResult.concat(m);if(this.jobBatchGroupIndex+1<this.jobBatchGroupRequest.length){this.runJobBatch(this.jobBatchGroupRequest[this.jobBatchGroupIndex+1],this.jobBatchGroupIndex+1)}else{var a=this.getSummaryGrid();if(a){a.updateTestStatus(e.params.id,e.params.testType,1,this.jobBatchGroupResult);this.setRunTestButtonState(false)}}}}}else{var a=this.getSummaryGrid();if(a){a.updateTestStatus(e.params.id,e.params.testType,1)}Ext.Msg.show({title:"Server Error",msg:"An error occurred attempting to ajax load data from the server.  No result was obtained",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})}}catch(l){Ext.Msg.show({title:"Critical Error",msg:l,buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}},preparePayload:function(b,e){var j=(e=="valueArray"?"value":"token");var f=(e=="valueArray"?"values":"tokens");var h=this.getForm();if(h){var g=h.getValues();if(b){var a=new Array();for(var d=0;d<b.length;d++){var c={};if(j=="value"){c.value=b[d]}else{c.token=b[d]}a.push(c)}}if(g.dbUser){g.dbPassword=this.getDBLoginValue(g.dbUser)}if(g.naeUser){g.naePassword=this.getHSMLoginValue(g.naeUser)}g[f]=a;return Ext.encode(g)}},processResultObject:function(g,f){if(f["ax25:testName"]&&f["ax25:testName"]["$"]){var a=f["ax25:testName"]["$"];var e="";if(f["ax25:testDescription"]&&f["ax25:testDescription"]["$"]){var e=f["ax25:testDescription"]["$"]}var d=0;if(f["ax25:throughputTokensPerSecond"]&&f["ax25:throughputTokensPerSecond"]["$"]){var d=f["ax25:throughputTokensPerSecond"]["$"]}var c=0;if(f["ax25:totalElapsedTimeMillis"]&&f["ax25:totalElapsedTimeMillis"]["$"]){var c=f["ax25:totalElapsedTimeMillis"]["$"];if(!isNaN(c)){c=c/1000}}var b=0;if(f["ax25:totalTokens"]&&f["ax25:totalTokens"]["$"]){var b=f["ax25:totalTokens"]["$"]}g.push({testName:a,testDescription:e,throughputTokensPerSecond:d,totalElapsedTimeMillis:c,totalTokens:b})}else{Ext.Msg.show({title:"No Status in response",msg:"There is no status object in the return structure.",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})}return g},dataLoadFailure:function(a,b){this.setRunTestButtonState(false);this.setChartState(true,true);this.environ.communicator.dataLoadFailure(a,b)},dataLoadSuccess:function(j,c){try{if(j&&j.responseText){var g=Ext.decode(j.responseText);if(this.environ.communicator.responseCheck2(g,c,this.requestType+"Response")){var b=new Array();var d=g["ns:"+this.requestType+"Response"]["ns:return"];if(d){if(Ext.isArray(d)){for(var e=0;e<d.length;e++){this.processResultObject(b,d[e])}}else{this.processResultObject(b,d)}}var a=this.getSummaryGrid();if(a){var f=(c.params.testType=="serverSideApiTest"?6000:12000);if(this.environ.staticContent){a.updateTestStatus.defer(f,a,[c.params.id,c.params.testType,1,b]);if(c.params.testType=="serverSideApiTest"){a.updateTestStatus.defer(f,a,[c.params.id,"webServerTest",-1,[]])}}else{a.updateTestStatus(c.params.id,c.params.testType,1,b);if(c.params.testType=="serverSideApiTest"){a.updateTestStatus(c.params.id,"webServerTest",-1,b)}}if(c.params.testType=="webServerTest"){if(this.environ.staticContent){this.setRunTestButtonState.defer(f,this,[false])}else{this.setRunTestButtonState(false)}}if(c.params.testType=="serverSideApiTest"){this.runWebServerTest(c.params)}}}}else{this.setRunTestButtonState(false);var a=this.getSummaryGrid();if(a){a.updateTestStatus(c.params.id,c.params.testType,0,[])
}Ext.Msg.show({title:"Server Error",msg:"An error occurred attempting to ajax load data from the server.  No result was obtained",buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR})}}catch(h){this.setRunTestButtonState(false);var a=this.getSummaryGrid();if(a){a.updateTestStatus(c.params.id,c.params.testType,0,[])}Ext.Msg.show({title:"Critical Error",msg:h,buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}}});Ext.reg("alvformquicktest",Ext.ux.alvand.form.QuickTestForm);Ext.namespace("Ext.ux.alvand.form");Ext.ux.alvand.form.CreateToken=Ext.extend(Ext.ux.alvand.form.BaseToken,{actionButtonText:"Create",resultsGridTitle:"Created Tokens",defaultActionParam:{luhnCheck:1},requestType:"insertBatch",staticResponseFile:"createtokenresults",iconCls:"x-icon-tickets",getCollectionParamName:function(){return"valueArray"},getItemDefinitionArray:function(){return[this.dbUserField,this.tableNameField,this.naeUserField,this.maskTypeField,this.tokenGrid]}});Ext.reg("alvformcreatetoken",Ext.ux.alvand.form.CreateToken);Ext.namespace("Ext.ux.alvand.form");Ext.ux.alvand.form.RedeemToken=Ext.extend(Ext.ux.alvand.form.BaseToken,{actionButtonText:"Redeem",resultsGridTitle:"Redeemed Tokens",defaultActionParam:{},requestType:"getBatch",staticResponseFile:"redeemtokenresults",iconCls:"x-icon-subscriptions",getCollectionParamName:function(){return"tokenArray"},getItemDefinitionArray:function(){this.maskTypeField.redeem=true;return[this.dbUserField,this.tableNameField,this.naeUserField,this.maskTypeField,this.tokenGrid]},listeners:{render:function(b){var a=Ext.getCmp(this.id+"_tokengrid");a.colModel.setColumnHeader(1,"Token")}}});Ext.reg("alvformredeemtoken",Ext.ux.alvand.form.RedeemToken);Ext.namespace("Ext.ux.alvand.form");Ext.ux.alvand.form.DeleteToken=Ext.extend(Ext.ux.alvand.form.BaseToken,{actionButtonText:"Delete",resultsGridTitle:"Deleted Tokens",defaultActionParam:{},tokenRequestType:"deleteTokenBatch",valueRequestType:"deleteValueBatch",requestType:"deleteValueBatch",tokenParamName:"tokenArray",valueParamName:"valueArray",collectionParamName:"valueArray",staticResponseFileRadio:"deletevalueresults",tokenStaticResponseFile:"deletetokenresults",valueStaticResponseFile:"deletevalueresults",iconCls:"x-icon-delete",getCollectionParamName:function(){return this.collectionParamName},getStaticResponseFile:function(){return this.staticResponseFileRadio},getItemDefinitionArray:function(){return[this.dbUserField,this.tableNameField,this.naeUserField,this.maskTypeField,this.locateByField,this.tokenGrid]},initFieldDefinitions:function(){this.locateByField={xtype:"radiogroup",tabIndex:5,fieldLabel:"Locate By",items:[{boxLabel:"Value",name:"locateby",inputValue:"value",checked:true,handler:function(a,c){if(c){var b=Ext.getCmp(this.id+"_tokengrid");b.colModel.setColumnHeader(1,"Value");this.requestType=this.valueRequestType;this.collectionParamName=this.valueParamName;this.staticResponseFileRadio=this.valueStaticResponseFile}},scope:this},{boxLabel:"Token",name:"locateby",inputValue:"token",handler:function(a,c){if(c){var b=Ext.getCmp(this.id+"_tokengrid");b.colModel.setColumnHeader(1,"Token");this.requestType=this.tokenRequestType;this.collectionParamName=this.tokenParamName;this.staticResponseFileRadio=this.tokenStaticResponseFile}},scope:this}]};Ext.ux.alvand.form.DeleteToken.superclass.initFieldDefinitions.call(this)}});Ext.reg("alvformdeletetoken",Ext.ux.alvand.form.DeleteToken);Ext.namespace("Ext.ux.alvand");Ext.ux.alvand.TokenManagementApp=Ext.extend(Ext.app.App,{requestType:"getTokenTableList",id:"tokenManagementApp",staticResponseFile:"tokenizedtables",loadAppDomain:function(){this.naeUserstore=new Ext.data.Store({reader:new Ext.data.ArrayReader({idProperty:"username"},[{name:"username"},{name:"password"},{name:"loggedin"}])});this.tokentablestore=Ext.ux.alvand.UserTokenTableStores.createStore();this.dbUserStore=new Ext.data.Store({reader:new Ext.data.JsonReader({root:"data",idProperty:"username",storeId:this.id+"_dbStore"},[{name:"username"},{name:"password"},{name:"loggedin"}]),listeners:{load:function(d,c,e){if(c){for(var f=0;f<c.length;f++){Ext.ux.alvand.UserTokenTableStores.register(c[f].get("username"),c[f].get("password"))}}},scope:this}});var b=Ext.util.Cookies.get("loginUsername");var a=Ext.util.Cookies.get("loginPassword");Ext.util.Cookies.clear("loginPassword");if(b&&a){this.dbLoginStore().loadData({data:[{username:b,password:a,loggedin:1}]});this.environ.currentUser=b;this.environ.uiStyle=Ext.state.Manager.get(this.environ.currentUser+"_alvand_uistyle","windows")}},dbLoginStore:function(){return this.dbUserStore},hsmLoginStore:function(){return this.naeUserstore},tokenTableStore:function(){return this.tokentablestore},displayLoginForm:function(c,a){var b=MyDesktop.modules[0].launcher.menu.items[0];MyDesktop.modules[0].createWindow(MyDesktop.modules[0].launcher.menu.items[(c=="HSM"?1:0)])},displayTokenTableForm:function(){var a=MyDesktop.modules[0].launcher.menu.items[0];MyDesktop.modules[0].createWindow(MyDesktop.modules[0].launcher.menu.items[2])}});/*
* Ext JS Library 3.3.1
* Copyright(c) 2006-2010 Sencha Inc.
* licensing@sencha.com
* http://www.sencha.com/license
*/
MyDesktop=new Ext.ux.alvand.TokenManagementApp({init:function(){Ext.chart.Chart.CHART_URL="../resources/charts.swf";Ext.Ajax.timeout=150000;Ext.QuickTips.init();Ext.WindowMgr.zseed=10000;var j=new Ext.state.CookieProvider({});Ext.state.Manager.setProvider(j);var k=false;var c=true;var h=document.location.href.indexOf("desktop-debug.html")>=0;var m=false;var d;if(document.location&&document.location.href&&document.location.href.indexOf("?")>-1){if(document.location.href.indexOf("#")>-1){d=document.location.href.substring(document.location.href.indexOf("?")+1,document.location.href.indexOf("#"))}else{d=document.location.href.substring(document.location.href.indexOf("?")+1)}if(d){var b=d.split("&");if(b){for(var f=0;f<b.length;f++){var a=b[f].split("=");if(a&&a.length==2){if(a[0]=="static"&&a[1]=="true"){k=true}else{if(a[0]=="valid"&&a[1]=="false"){c=false}else{if(a[0]=="fisheye"&&a[1]=="true"){m=true}}}}}}}}globalKeyMap=new Ext.KeyMap(document);globalKeyMap.accessKey=function(i,p,o){if(p){var n=function(r,q){q.preventDefault();p.call(o||this,r,q)};this.on(i,n,o)}};var g=":";var e="../alvand/data/";this.environ={debugContent:h,paramString:d,staticContent:k,rootUrl:(k?e:"/axis2/services/"),staticUrl:e,validContent:c,historyDelimitor:g,communicator:Ext.ux.alvand.Communicator};Ext.ux.alvand.UserTokenTableStores.setEnvironment(this.environ);this.loadAppDomain();if(m){var l=new Ext.ux.FisheyeMenuExtention({renderTo:"fisheye-menu",hAlign:"center",vAlign:"top",itemWidth:48,items:[{text:"Token Manager",imagePath:"images/token48x48.png",onclick:"MyDesktop.launchHelper('dblogins');"},{text:"Animation Studio",imagePath:"images/animation.png",onclick:"MyDesktop.launchHelper('dslogins');"},{text:"Todays Specials",imagePath:"images/fries_img.png",onclick:"MyDesktop.launchHelper('tokentables');"}]})}},getModules:function(){return[new MyDesktop.ConfigurationMenuModule(),new MyDesktop.TokenManagementMenuModule(),new MyDesktop.PerformanceMenuModule(),new MyDesktop.HelpWindow(),new MyDesktop.LogWindow(),new MyDesktop.WizardWindow()]},launchHelper:function(b){if(b){var c=MyDesktop;if(c.modules){for(var d=0;d<c.modules.length;d++){if(c.modules[d].launcher&&c.modules[d].launcher.menu&&c.modules[d].launcher.menu.items){for(var a=0;a<c.modules[d].launcher.menu.items.length;a++){if(c.modules[d].launcher.menu.items[a].code==b){c.modules[d].createWindow(c.modules[d].launcher.menu.items[a]);break}}}}}}},launchFinder:function(){var b=this.getDesktop();var a=b.getWindow("finder-win");if(!a){a=b.createWindow({id:"finder-win",title:"Finder",width:400,height:300,iconCls:"icon-grid",shim:false,animCollapse:false,constrainHeader:true,layout:"fit",items:[{xtype:"label",text:"Coming Soon"}]})}a.show()},getStartConfig:function(){return{title:(this.userStruct?this.userStruct.fullname:""),iconCls:"user",toolItems:[{text:"Settings",iconCls:"settings",handler:function(){var b=this.getDesktop();var a=b.getWindow("about-win");if(!a){a=b.createWindow({id:"about-win",title:"Settings",width:400,height:300,iconCls:"icon-grid",shim:false,animCollapse:false,constrainHeader:true,layout:"fit",items:[{xtype:"form",style:"padding: 5px;",frame:true,border:true,bodyStyle:"padding:5px 5px 0;",autoScroll:true,anchor:"-20",items:[{fieldLabel:"Username",xtype:"textfield",readOnly:true,value:this.environ.currentUser},{xtype:"radiogroup",fieldLabel:"UI Style",listeners:{render:function(c){var d=(MyDesktop.environ.uiStyle?MyDesktop.environ.uiStyle:"windows");if(d){c.setValue(d)}},change:function(c,d){if(d.getValue()){MyDesktop.environ.uiStyle=c.getValue().inputValue;Ext.state.Manager.set(MyDesktop.environ.currentUser+"_alvand_uistyle",MyDesktop.environ.uiStyle)}}},items:[{boxLabel:"Windows",name:"uistyle",inputValue:"windows",scope:this},{boxLabel:"Mac",name:"uistyle",inputValue:"mac",scope:this}]}]}]})}a.show()},scope:this},"-",{text:"Logout",iconCls:"logout",handler:function(){document.location.href="login"+(this.environ.debugContent?"-debug":"")+".html"+(this.environ.paramString&&this.environ.paramString.length>0?"?"+this.environ.paramString:"")
},scope:this},"-",{text:"About",iconCls:"alv-log-info",tooltip:"about this Alvand Solutions product...",handler:function(){var b=this.getDesktop();var a=b.getWindow("about-win");if(!a){a=b.createWindow({id:"about-win",title:"About This Product",width:400,height:300,iconCls:"icon-grid",shim:false,animCollapse:false,constrainHeader:true,layout:"fit",items:[{xtype:"alviframe",url:"/help/about.html"}]})}a.show()},scope:this}]}}});MyDesktop.HelpWindow=Ext.extend(Ext.app.Module,{id:"help-win",init:function(){this.launcher={text:"Help Library",iconCls:"alv-book",handler:this.createWindow,scope:this}},createWindow:function(a){var b=MyDesktop;var d=b.getDesktop();var c=d.getWindow("help-win");if(!c){c=d.createWindow({id:"help-win",stateful:true,stateId:"help-win",title:"Help Library",width:700,height:600,iconCls:"icon-grid",shim:false,animCollapse:false,constrainHeader:true,layout:"fit",items:new Ext.ux.alvand.HelpPanel({xtype:"alvhelp",environ:b.environ,collapsible:false,collapsed:false})})}c.show();if(a){a.target=c.el.id;a.windowId=c.id}}});MyDesktop.LogWindow=Ext.extend(Ext.app.Module,{id:"log-win",init:function(){this.launcher={text:"Log Viewer",iconCls:"x-icon-tables",handler:this.createWindow,scope:this}},createWindow:function(a){var b=MyDesktop;var d=b.getDesktop();var c=d.getWindow("log-win");c=d.createWindow({id:"log-win_"+b.environ.communicator.guid(),stateful:true,stateId:"log-win",title:"Log Viewer",width:700,height:600,iconCls:"icon-grid",shim:false,animCollapse:false,constrainHeader:true,layout:"fit",items:new Ext.ux.alvand.LogViewer({environ:b.environ,collapsible:false,collapsed:false})});c.show();if(a){a.target=c.el.id;a.windowId=c.id}}});MyDesktop.WizardWindow=Ext.extend(Ext.app.Module,{id:"wizard-win",init:function(){this.launcher={text:"Feature Walk-thru",iconCls:"x-icon-tables",handler:this.createWindow,scope:this}},createWindow:function(){Ext.ux.alvand.WizardItinaryManager.start("overview")}});var windowIndex=0;MyDesktop.TokenManagementModule=Ext.extend(Ext.app.Module,{init:function(){this.launcher={text:"Window "+(++windowIndex),iconCls:"bogus",handler:this.createWindow,scope:this,windowId:windowIndex}},createWindow:function(d,a){var b=MyDesktop;var e=b.getDesktop();var c=e.getWindow(d.code+"_"+d.windowId);if(!c){c=e.createWindow({id:d.code+"_"+d.windowId,stateful:true,stateId:d.code+"_"+d.windowId,title:d.text,width:480,height:605,iconCls:d.iconCls,shim:false,animCollapse:false,constrainHeader:true,layout:"fit",items:[d.windowContents(this)]})}c.show();if(a){a.target=c.el.id;a.windowId=c.id}}});MyDesktop.TokenManagementMenuModule=Ext.extend(MyDesktop.TokenManagementModule,{init:function(){this.launcher={text:"Token Management",iconCls:"x-icon-tickets",handler:function(){return false},menu:{items:[{code:"createtoken",text:"Create",iconCls:"x-icon-tickets",handler:this.createWindow,scope:this,windowId:windowIndex,windowContents:function(a){return{xtype:"alvformcreatetoken",environ:a.app.environ,dbUserStore:a.app.dbLoginStore(),naeUserstore:a.app.hsmLoginStore(),tokentablestore:a.app.tokenTableStore()}}},{code:"redeemtoken",text:"Redeem",iconCls:"x-icon-subscriptions",handler:this.createWindow,scope:this,windowId:windowIndex,windowContents:function(a){return{xtype:"alvformredeemtoken",environ:a.app.environ,dbUserStore:a.app.dbLoginStore(),naeUserstore:a.app.hsmLoginStore(),tokentablestore:a.app.tokenTableStore()}}},{code:"deletetoken",text:"Delete",iconCls:"x-icon-delete",handler:this.createWindow,scope:this,windowId:windowIndex,windowContents:function(a){return{xtype:"alvformdeletetoken",environ:a.app.environ,dbUserStore:a.app.dbLoginStore(),naeUserstore:a.app.hsmLoginStore(),tokentablestore:a.app.tokenTableStore()}}}]}}}});MyDesktop.ConfigurationModule=Ext.extend(Ext.app.Module,{init:function(){this.launcher={text:"Window "+(++windowIndex),iconCls:"bogus",handler:this.createWindow,scope:this,windowId:windowIndex}},createWindow:function(d,a){var b=MyDesktop;var e=b.getDesktop();var c;if(!d.multiWindow){c=e.getWindow(d.code+"_"+d.windowId)
}if(!c){c=e.createWindow({id:d.code+"_"+d.windowId+(d.multiWindow?"_"+b.environ.communicator.guid():""),stateful:true,stateId:d.code+"_"+d.windowId,title:d.text,width:(d.width?d.width:540),height:(d.height?d.height:300),iconCls:d.iconCls,shim:false,animCollapse:false,constrainHeader:true,layout:"fit",items:[d.windowContents(this)]})}c.show();if(a){a.target=c.el.id;a.windowId=c.id}}});MyDesktop.ConfigurationMenuModule=Ext.extend(MyDesktop.ConfigurationModule,{init:function(){this.launcher={text:"Configuration",iconCls:"alv-gears",handler:function(){return false},menu:{items:[{code:"dblogins",text:"Token Manager",multiWindow:false,iconCls:"x-icon-users",handler:this.createWindow,scope:this,windowId:windowIndex,windowContents:function(a){return{xtype:"alviframe",anchor:"-20",environ:a.app.environ,url:"http://localhost/TokenManager/ext/desktop/login-debug.html?static=true"}}},{code:"dslogins",text:"Animation Studio",iconCls:"x-icon-users",handler:this.createWindow,scope:this,windowId:windowIndex,windowContents:function(a){return{xtype:"alviframe",anchor:"-20",environ:a.app.environ,url:"http://localhost/LostCoastStudios/animationstudio/www/index.html"}}},{code:"tokentables",text:"Tokenized Tables",iconCls:"x-icon-tables",handler:this.createWindow,width:734,height:300,multiWindow:true,scope:this,windowId:windowIndex,windowContents:function(b){var a=b.app.environ.communicator.guid();return{xtype:"alviframe",anchor:"-20",environ:b.app.environ,url:"http://localhost/ProximitySolutions/animationstudio/www/index.html"}}}]}}}});MyDesktop.PerformanceModule=Ext.extend(Ext.app.Module,{init:function(){this.launcher={text:"Window "+(++windowIndex),iconCls:"bogus",handler:this.createWindow,scope:this,windowId:windowIndex}},createWindow:function(d,a){var b=MyDesktop;var e=b.getDesktop();var c;if(!d.multiWindow){c=e.getWindow(d.code+"_"+d.windowId)}if(!c){c=e.createWindow({id:d.code+"_"+d.windowId+(d.multiWindow?"_"+b.environ.communicator.guid():""),stateful:true,stateId:d.code+"_"+d.windowId,title:d.text,width:(d.width?d.width:795),height:(d.height?d.height:510),iconCls:d.iconCls,shim:false,animCollapse:false,constrainHeader:true,layout:"fit",items:[d.windowContents(this)]})}c.show();if(a){a.target=c.el.id;a.windowId=c.id}}});MyDesktop.PerformanceMenuModule=Ext.extend(MyDesktop.PerformanceModule,{init:function(){this.launcher={text:"Performance",iconCls:"alv-gears",handler:function(){return false},menu:{items:[{code:"perfquicktest",text:"Quick Test",multiWindow:false,iconCls:"x-icon-users",handler:this.createWindow,scope:this,windowId:windowIndex,windowContents:function(a){return{xtype:"alvformquicktest",environ:a.app.environ,dbUserStore:a.app.dbLoginStore(),naeUserstore:a.app.hsmLoginStore(),tokentablestore:a.app.tokenTableStore()}}}]}}}});Ext.namespace("Ext.ux.alvand.grid");Ext.ux.alvand.grid.LogViewerGrid=Ext.extend(Ext.grid.GridPanel,{viewConfig:{forceFit:true},environ:{},frame:true,initComponent:function(){this.initToolBar();var a=function(){return'<textarea readonly class="x-form-textarea x-form-field">'+arguments[0]+"</textarea>"};function b(c){return'<div style="white-space:normal !important;">'+c+"</div>"}this.columns=[{header:"Time",width:40,sortable:true,dataIndex:"time"},{xtype:"actioncolumn",header:"Level",sortable:true,dataIndex:"statusCode",width:10,items:[{getClass:function(c,e,f){var d=f.get("statusCode");if(d=="FATAL"){return"alv-log-fatal"}else{if(d=="ERROR"){return"alv-log-error"}else{if(d=="WARN"){return"alv-log-warn"}else{if(d=="INFO"){return"alv-log-info"}else{if(d=="DEBUG"){return"alv-log-debug"}else{return"alv-log-trace"}}}}}}}]},{header:"Log Entry",sortable:true,dataIndex:"text",renderer:b}];this.store=new Ext.data.Store({reader:new Ext.data.JsonReader({root:"logentries",storeId:this.id+"_rStore"},[{name:"time"},{name:"text"},{name:"statusCode"}])});Ext.ux.alvand.grid.LogViewerGrid.superclass.initComponent.call(this)},setTotalEntryCount:function(a){Ext.getCmp(this.id+"_entryCount").setValue(a)},applyLevelFilter:function(b){var a=(b?b:Ext.getCmp(this.id+"_loglevel"));if(a){if(a.getValue()!="ALL"){this.getStore().filter([{property:"statusCode",value:a.getValue(),anyMatch:false,caseSensitive:false,exactMatch:true}])}else{this.getStore().clearFilter()}}},initToolBar:function(){var a=new Ext.data.SimpleStore({fields:["level","text"],data:[["ALL","All"],["FATAL","Fatal"],["ERROR","Error"],["WARN","Warning"],["INFO","Information"],["DEBUG","Debug"],["TRACE","Trace"]]});this.tbar=[{id:this.id+"_loglevel",xtype:"combo",store:a,displayField:"text",valueField:"level",typeAhead:true,mode:"local",triggerAction:"all",emptyText:"Select logging level...",selectOnFocus:true,value:this.defaultLevel,width:135,forceSelection:true,listeners:{afterrender:function(b){if(b.store&&b.store.getCount()>1){var c=b.store.getAt(0);if(c){b.fireEvent.defer(100,b,["change",b,c.get("level"),""]);b.setValue(c.get("level"))}}},select:{fn:function(c,b){this.applyLevelFilter(c)}},change:{fn:function(d,c,b){this.applyLevelFilter(d)}},scope:this}},"->",{xtype:"label",style:"color:white;margin-left:5px;margin-right:5px;",text:"Total Entries"},{id:this.id+"_entryCount",xtype:"numberfield",allowNegative:false,allowDecimals:false,readOnly:true,value:0,width:50}]}});Ext.reg("alvgridlogviewer",Ext.ux.alvand.grid.LogViewerGrid);Ext.namespace("Ext.ux.alvand");Ext.ux.alvand.LogViewer=Ext.extend(Ext.Panel,{_pause:false,bodyStyle:{overflow:"auto"},titleCollapse:false,collapsible:false,closable:true,header:false,border:true,shim:true,layout:"anchor",maxBufferSize:250,defaultRefreshInterval:5,defaultBlockSize:10,initComponent:function(){this.items=[];this.initToolBar();this.items.push({title:this.gridResultsTitle,id:this.id+"_logviewergrid",xtype:"alvgridlogviewer",environ:this.environ,anchor:"-2 -2"});Ext.ux.alvand.LogViewer.superclass.initComponent.call(this)},getGrid:function(){return Ext.getCmp(this.id+"_logviewergrid")},initToolBar:function(){var a=new Ext.data.SimpleStore({fields:["displayname","filename"],data:[["Web Server","/wbs/web.log"],["Db Server","/wbs/db.log"],["DataSecure Appliance","/wbs/appliance.log"]]});this.tbar=[{loggerId:this.id,text:"Start",tooltip:"Start streaming the log",iconCls:"alv-start",handler:this.start,enableToggle:true,pressed:false,width:65,scope:this},{text:"Pause",tooltip:"Pause/Start log refresh ",iconCls:"alv-pause",handler:this.pause,enableToggle:true,pressed:false,width:65,scope:this},{text:"Reset",tooltip:"Clear the log window",iconCls:"alv-reset",width:65,handler:this.reset,scope:this},"-",{xtype:"combo",store:a,displayField:"displayname",valueField:"filename",typeAhead:true,mode:"local",triggerAction:"all",emptyText:"Select log file...",selectOnFocus:true,value:this.defaultLevel,width:135,listeners:{afterrender:function(b){if(b.store&&b.store.getCount()>1){var c=b.store.getAt(0);if(c){b.fireEvent.defer(100,b,["change",b,c.get("filename"),""]);b.setValue(c.get("filename"))}}},select:{fn:function(d,b){var c=this.ownerCt.ownerCt.ownerCt;c.setTitle(d.getRawValue()+" Log")}},change:{fn:function(e,d,b){var c=this.ownerCt.ownerCt.ownerCt;c.setTitle(e.getRawValue()+" Log")}}}},"->",{xtype:"label",style:"color:white;margin-left:5px;margin-right:5px;",text:"Refresh Interval (sec)"},{id:this.id+"_refreshinterval",xtype:"numberfield",allowNegative:false,allowDecimals:false,tooltip:"how often in seconds to reaquire log entries",value:this.defaultRefreshInterval,width:50},{xtype:"label",style:"color:white;margin-left:5px;margin-right:5px;",tooltip:"The maximum number of log entries returned per refresh (to minimize network transport latency)",text:"Response Record Size"},{id:this.id+"_blockSize",xtype:"numberfield",allowNegative:false,allowDecimals:false,value:this.defaultBlockSize,width:50}]},start:function(b,d){b.setText((b.pressed?"Stop":"Start"));b.setIconClass(b.pressed?"alv-stop":"alv-start");if(this.ajaxRequestId){Ext.Ajax.abort(this.ajaxRequestId);delete this.ajaxRequestId}if(this.logtask){Ext.TaskMgr.stop(this.logtask);delete this.logtask}if(b.pressed){var c=Ext.getCmp(this.id+"_refreshinterval");var a=c.getValue();if(isNaN(a)||a==0){a=this.defaultRefreshInterval}if(c){this.logtask=Ext.TaskMgr.start({run:this.readLog,interval:a*1000,scope:this})}}},readLog:function(){if(!this._pause){var a=this.environ.staticUrl+"log_response.txt";var b={};this.ajaxRequestId=Ext.Ajax.request({url:a,success:this.dataLoadSuccess,failure:this.dataLoadFailure,method:"POST",scope:this})}},scrollToBottom:function(){try{var c=this.getGrid();if(c){var d=c.getGridEl();var b=c.getView().getRow(c.getStore().getCount()-1);if(b){b.scrollIntoView(d,false)}}}catch(a){}},dataLoadSuccess:function(k,d){try{if(k&&k.responseText){var a=this.getGrid();if(a){var g=Ext.decode(k.responseText);if(g&&g.logentries){var b=Ext.getCmp(this.id+"_blockSize");if(b){var f=b.getValue();if(isNaN(f)||f==0){f=this.defaultBlockSize}var i=(f<g.logentries.length?g.logentries.slice(0,f):g.logentries);var e=["FATAL","DEBUG","DEBUG","DEBUG","DEBUG","DEBUG","DEBUG","DEBUG","DEBUG","INFO","INFO","INFO","INFO","INFO","INFO","INFO","INFO","INFO","INFO","INFO","INFO","WARN","WARN","ERROR","TRACE","TRACE","TRACE","TRACE","TRACE","TRACE","TRACE","TRACE","TRACE","TRACE","TRACE"];for(var c=0;c<i.length;c++){i[c].time=new Date().toUTCString();i[c].statusCode=e[Math.floor(Math.random()*36)]
}a.getStore().loadData({logentries:i},true);a.applyLevelFilter();if(a.getStore().getCount()>this.maxBufferSize){a.getStore().remove(a.getStore().getRange(0,a.getStore().getCount()-this.maxBufferSize-1))}this.scrollToBottom();a.setTotalEntryCount(a.getStore().getCount())}}}}}catch(h){Ext.Msg.show({title:"Could not read log file",msg:h,buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}},dataLoadFailure:function(b,c){try{}catch(a){Ext.Msg.show({title:"Could not read log file",msg:a,buttons:Ext.Msg.OK,animEl:"elId",icon:Ext.MessageBox.ERROR});return false}},onLogLevelSelect:function(c,a,b){},reset:function(){this.getGrid().getStore().removeAll();this.getGrid().setTotalEntryCount(grid.getStore().getCount())},pause:function(a,b){this._pause=a.pressed;a.setText((a.pressed?"Resume":"Pause"))}});Ext.reg("alvlogviewer",Ext.ux.alvand.LogViewer);